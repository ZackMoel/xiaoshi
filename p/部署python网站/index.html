<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="如何部署python的代码 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 既然是">
<title>部署python网站</title>

<link rel='canonical' href='https://ZackMoel.github.io/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/'>

<link rel="stylesheet" href="/xiaoshi/scss/style.min.0304c6baf04e01a8fe70693791cb744d56a3578a3120a8796cefc66825aa39c7.css"><meta property='og:title' content="部署python网站">
<meta property='og:description' content="如何部署python的代码 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 既然是">
<meta property='og:url' content='https://ZackMoel.github.io/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/'>
<meta property='og:site_name' content='小诗的博客'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-04-14T16:58:32&#43;08:00'/><meta property='article:modified_time' content='2025-04-14T16:58:32&#43;08:00'/>
<meta name="twitter:title" content="部署python网站">
<meta name="twitter:description" content="如何部署python的代码 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 既然是">
  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/xiaoshi/">
                
                    
                    
                    
                        
                        <img src="/xiaoshi/img/avatar_hu8920112365793990935.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">🍥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/xiaoshi">小诗的博客</a></h1>
            <h2 class="site-description">欢迎来到小诗的博客</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/1055981889?spm_id_from=333.1007.0.0'
                        target="_blank"
                        title="bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/ZackMoel/xiaoshi.github.io'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/xiaoshi/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xiaoshi/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xiaoshi/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xiaoshi/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索</span>
            </a>
        </li>
        
        
        <li >
            <a href='/xiaoshi/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>友情链接</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>暗色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li>
      <ol>
        <li><a href="#前后端分离">前后端分离</a>
          <ol>
            <li><a href="#概念">概念</a></li>
            <li><a href="#部署方式">部署方式</a></li>
            <li><a href="#nginx-配置示例">Nginx 配置示例</a></li>
          </ol>
        </li>
        <li><a href="#前后端不分离">前后端不分离</a>
          <ol>
            <li><a href="#概念-1">概念</a></li>
            <li><a href="#部署方式-1">部署方式</a></li>
            <li><a href="#nginx-配置示例-1">Nginx 配置示例</a></li>
          </ol>
        </li>
        <li><a href="#总结">总结</a></li>
        <li><a href="#vuejs">Vue.js</a></li>
        <li><a href="#nodejs">Node.js</a></li>
        <li><a href="#nginx">Nginx</a></li>
        <li><a href="#协同工作流程">协同工作流程</a></li>
        <li><a href="#典型架构">典型架构</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li><a href="#为什么要使用堡垒机">为什么要使用堡垒机</a></li>
    <li><a href="#跳板机和堡垒机">跳板机和堡垒机</a></li>
  </ol>

  <ol>
    <li><a href="#服务器准备">服务器准备</a></li>
    <li><a href="#mysqlredisdb-51数据库机器">mysql、redis（db-51，数据库机器）</a>
      <ol>
        <li><a href="#redis内存型数据库">redis内存型数据库</a></li>
      </ol>
    </li>
    <li><a href="#core核心堡垒机后端服务内存至少4g其他服务起不来">core(核心堡垒机后端服务)（内存至少4G，其他服务起不来）</a>
      <ol>
        <li><a href="#基础环境安装">基础环境安装</a></li>
        <li><a href="#python36开发环境安装">python3.6开发环境安装</a></li>
        <li><a href="#补充设置pip3的下载源豆瓣源加速模块下载">补充：设置pip3的下载源，豆瓣源，加速模块下载</a></li>
        <li><a href="#python3的虚拟环境安装虚拟环境原理就是在修改path变量">python3的虚拟环境安装（虚拟环境原理就是在修改PATH变量）</a></li>
        <li><a href="#为什么激活虚拟环境后解释器用which查看的路径就变了">为什么激活虚拟环境后，解释器用which查看的路径就变了。</a></li>
        <li><a href="#安装jumpserver后端所需的python依赖">安装jumpserver后端所需的python依赖</a></li>
        <li><a href="#再次确认物理环境和虚拟环境的区别">再次确认，物理环境，和虚拟环境的区别</a></li>
        <li><a href="#解决pip版本太低的问题升级即可">解决pip版本太低的问题，升级即可</a></li>
        <li><a href="#下一步python3环境好了之后可以运行项目了">下一步，python3环境好了之后，可以运行项目了</a></li>
        <li><a href="#修改jumpserver代码的配置文件">修改jumpserver代码的配置文件</a></li>
        <li><a href="#数据库迁移">数据库迁移</a></li>
        <li><a href="#有了数据之后可以启动后端了">有了数据之后，可以启动后端了</a></li>
        <li><a href="#首次访问登录修改密码">首次访问，登录，修改密码</a></li>
      </ol>
    </li>
    <li><a href="#lina前端可视化前端页面">lina前端(可视化前端页面)</a>
      <ol>
        <li><a href="#部署前端lina全流程">部署前端lina全流程</a></li>
        <li><a href="#配置前端npm的下载加速源">配置前端npm的下载加速源</a></li>
        <li><a href="#理解npm和node的关系对比pip和python的关系">理解npm和node的关系（对比pip和python的关系）</a></li>
        <li><a href="#安装前端源代码的依赖">安装前端源代码的依赖</a></li>
        <li><a href="#修改前端的js文件设置一些运行参数">修改前端的js文件，设置一些运行参数</a></li>
        <li><a href="#运行lina前端项目">运行lina前端项目</a></li>
        <li><a href="#测试访问前端">测试访问前端</a></li>
        <li><a href="#前端lina后端core的架构图">前端lina、后端core的架构图</a></li>
      </ol>
    </li>
    <li><a href="#luna前端网页版命令行">luna前端（网页版命令行）</a>
      <ol>
        <li><a href="#修改luna-的配置文件">修改luna 的配置文件</a></li>
        <li><a href="#启动luna">启动luna</a></li>
        <li><a href="#测试访问luna">测试访问luna</a></li>
      </ol>
    </li>
    <li><a href="#koko后端命令行版堡垒机">koko后端（命令行版堡垒机）</a>
      <ol>
        <li><a href="#部署koko">部署koko</a></li>
        <li><a href="#启动koko">启动koko</a></li>
        <li><a href="#此时你可以试试跳板机的实际用法了1访问luna的网页命令行">此时你可以试试，跳板机的实际用法了，1.访问luna的网页命令行</a></li>
        <li><a href="#以及试试基于ssh协议连接koko">以及试试，基于ssh协议连接koko</a></li>
      </ol>
    </li>
    <li><a href="#部署lion提供vnc远程桌面功能">部署lion（提供vnc远程桌面功能）</a>
      <ol>
        <li><a href="#先装一个工具叫做-guacamole远程桌面依赖的一个前端框架">先装一个工具叫做 guacamole，远程桌面依赖的一个前端框架</a></li>
        <li><a href="#安装lion程序">安装lion程序</a></li>
        <li><a href="#启动guacd程序">启动guacd程序</a></li>
        <li><a href="#启动lion进程">启动lion进程</a></li>
      </ol>
    </li>
    <li><a href="#部署nginx整合所有组件提供统一的七层反向代理">部署nginx（整合所有组件，提供统一的七层反向代理）</a>
      <ol>
        <li><a href="#部署nginx的配置文件">部署nginx的配置文件</a></li>
      </ol>
    </li>
    <li><a href="#图解nginx配置">图解nginx配置</a>
      <ol>
        <li><a href="#注意配置文件中用的都是测试域名你要在master-61上做好hosts解析">注意，配置文件中用的都是测试域名，你要在master-61上做好hosts解析</a></li>
        <li><a href="#最后启动nginx访问入口">最后，启动nginx，访问入口</a></li>
        <li><a href="#注意客户端windows也做好域名解析">注意，客户端，windows也做好域名解析</a></li>
      </ol>
    </li>
  </ol>

  <ol>
    <li>
      <ol>
        <li><a href="#确保可以正确登录整个实验就没问题了">确保可以正确登录，整个实验就没问题了。</a></li>
        <li><a href="#堡垒机大盘页面">堡垒机大盘页面</a></li>
        <li><a href="#个人信息页面">个人信息页面</a></li>
        <li><a href="#总之你在页面上确保点点点各种链接访问都是正常的">总之，你在页面上，确保点点点，各种链接，访问都是正常的</a></li>
        <li><a href="#以最终看到个人页面为结束">以最终看到，个人页面为结束</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/">部署python网站</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-04-14</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="如何部署python的代码">如何部署python的代码
</h1><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">既然是运维，运维，部署，维护
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">一个完整的产品、 前端开发工程师(前端代码 html,css,js) + 后端工程师（编写和数据库交互的逻辑代码）
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">前端、后端源码，打包，发给运维，部署到linux服务器上
</span></span><span class="line"><span class="cl">1.如果是web产品，需要运维，部署如nginx这样的web服务器，提供域名，端口，防火墙，等允许网站在公网中的可访问。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2. 如果是控制汽车运行的智能算法系统，仅仅要求在linux上运行。基本都要提供基于http协议的一个访问服务。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">3. 单纯的计算服务，在系统上，确保可以运行即可,不提供socket(ip:port)让客户端去访问。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">不同的公司，使用的技术栈不一样，基本是根据企业的技术沉淀有关，以及招聘来的技术老大有关。决定你开发技术栈，架构，用什么形式的。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">早期的，老旧的技术栈，单体应用， 前后端不分离开发模式。（前端、后端代码，糅杂在一起，后端代码，也包括前端代码）
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">后端代码文件，里面还能看到html这样的标签。。。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">具体部署形式，比较简单，整个代码，跑起来，甩给nginx去反向代理即可。，如，经典的wordpress，用的是php后端。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">如果你去其他公司，如360这样公司，大量使用php，那么你的日常维护，部署工作，基本是围绕着LNMP来打转。。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-------------------------
</span></span><span class="line"><span class="cl">如果你是去了一些新型的互联网公司，某单位，技术栈，用的都是比较新的，复杂的。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">看主流，常见的部署技术栈
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">php + html + css + js  = wordpress
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python + vue  = jumpserver
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">借助浏览器插件： Wappalyzer
</span></span><span class="line"><span class="cl">可以很方便的看到网站，是基于什么技术开发的
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">现在大多数网站，前端都是基于vue开发
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">后端，编程语言选择性很多
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">数据库，基本是mysql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">javascript框架，就知道，这是前端的服务器框架   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python框架，就知道后端用的是python  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">bilibili.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">前端 服务器是  运行着 vue.js进程的服务器
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">后端服务器  是运行着   golang 进程的服务器
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">数据库服务器，运行着mysql进程的服务器
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="前后端分离和不分离">前后端分离和不分离
</h1><p>在部署 Web 应用时，Nginx 可以用于支持前后端分离和不分离的架构。以下是这两种部署方式的区别和示例配置：</p>
<h3 id="前后端分离">前后端分离
</h3><h4 id="概念">概念
</h4><ul>
<li><strong>前端</strong>：通常使用框架如 Vue.js、React 等，构建成静态文件（HTML、CSS、JS）。</li>
<li><strong>后端</strong>：使用 Node.js、Django、Spring 等提供 API 服务。</li>
</ul>
<h4 id="部署方式">部署方式
</h4><ul>
<li><strong>前端</strong>：Nginx 负责托管静态文件。</li>
<li><strong>后端</strong>：Nginx 通过反向代理将 API 请求转发到后端服务。</li>
</ul>
<h4 id="nginx-配置示例">Nginx 配置示例
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span> <span class="s">example.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">root</span> <span class="s">/path/to/frontend/dist</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="nv">$uri/</span> <span class="s">/index.html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/api/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_pass</span> <span class="s">http://localhost:3000</span><span class="p">;</span>  <span class="c1"># Node.js 服务
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="前后端不分离">前后端不分离
</h3><h4 id="概念-1">概念
</h4><ul>
<li><strong>集成</strong>：前后端代码在同一个项目中开发和部署。</li>
<li><strong>模板渲染</strong>：后端使用模板引擎（如 EJS、Thymeleaf）直接渲染 HTML。</li>
</ul>
<h4 id="部署方式-1">部署方式
</h4><ul>
<li>Nginx 主要作为反向代理，所有请求都转发到后端服务。</li>
<li>后端服务负责提供完整的页面和 API。</li>
</ul>
<h4 id="nginx-配置示例-1">Nginx 配置示例
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span> <span class="s">example.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_pass</span> <span class="s">http://localhost:3000</span><span class="p">;</span>  <span class="c1"># 后端服务
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="总结">总结
</h3><ul>
<li><strong>前后端分离</strong>：更灵活，前端和后端可以独立开发、部署和扩展。</li>
<li><strong>前后端不分离</strong>：更简单的项目架构，适合小型应用或快速开发。</li>
</ul>
<p>选择合适的架构和部署方式根据项目需求、团队结构和技术栈而定。</p>
<blockquote>
<p>补充，nginx和vue和node.js的关系</p>
<p>Nginx、Vue.js 和 Node.js 在现代 web 开发中常常一起使用，形成一个完整的前后端架构。以下是它们之间的关系和协作方式：</p>
<h3 id="vuejs">Vue.js
</h3><ul>
<li><strong>前端框架</strong>：用于构建用户界面的 JavaScript 框架，特别适合单页应用（SPA）。</li>
<li><strong>开发工具</strong>：使用 Vue CLI 等工具进行开发、组件化和状态管理。</li>
</ul>
<h3 id="nodejs">Node.js
</h3><ul>
<li><strong>后端运行环境</strong>：基于 Chrome V8 引擎的 JavaScript 运行时，用于构建快速、可扩展的网络应用。</li>
<li><strong>API 服务</strong>：通常用于构建后端 RESTful API，以支持前端应用的数据交互。</li>
<li><strong>构建工具</strong>：Node.js 也用于前端构建工具（如 Webpack、Vite）来打包和优化 Vue.js 应用。</li>
</ul>
<h3 id="nginx">Nginx
</h3><ul>
<li><strong>Web 服务器</strong>：用于托管静态文件（如 Vue.js 构建后的文件）和反向代理请求。</li>
<li><strong>负载均衡</strong>：可以将请求分发到多个 Node.js 实例，提高应用的可用性和性能。</li>
<li><strong>缓存</strong>：支持静态内容缓存，提高访问速度。</li>
</ul>
<h3 id="协同工作流程">协同工作流程
</h3><ol>
<li><strong>前端开发</strong>：
<ul>
<li>使用 Vue.js 开发应用，Node.js 作为构建工具运行开发服务器。</li>
</ul>
</li>
<li><strong>构建和打包</strong>：
<ul>
<li>使用 Node.js 中的工具（如 Webpack、Vite）将 Vue.js 应用打包成静态文件。</li>
</ul>
</li>
<li><strong>部署</strong>：
<ul>
<li><strong>Nginx</strong>：托管打包后的静态文件。</li>
<li><strong>Node.js</strong>：运行后端服务，处理 API 请求。</li>
</ul>
</li>
<li><strong>Nginx 配置示例</strong>：</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span> <span class="s">yourdomain.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">root</span> <span class="s">/path/to/your/dist</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="nv">$uri/</span> <span class="s">/index.html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/api/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_pass</span> <span class="s">http://localhost:3000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="典型架构">典型架构
</h3><ul>
<li><strong>用户请求</strong>：通过浏览器访问 Vue.js 应用。</li>
<li><strong>静态文件</strong>：Nginx 提供静态文件（HTML、CSS、JavaScript）。</li>
<li><strong>API 请求</strong>：Nginx 将 API 请求转发到 后端。</li>
<li><strong>数据处理</strong>：后端 处理请求并与数据库交互，返回数据给前端。</li>
</ul>
<p>这种架构充分利用了各个组件的优势，Nginx 提供高效的静态内容服务和反向代理功能，Vue.js 提供灵活的前端开发体验</p>
</blockquote>
<h1 id="部署堡垒机jumpserverpythonvuegolang">部署堡垒机jumpserver(python+vue+golang)
</h1><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">生产级别，较为复杂的项目部署。
</span></span><span class="line"><span class="cl">前后端分离的如何部署：
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">独立的前端vue项目部署
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">独立的python项目部署
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">独立的mysql、redis数据库
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">独立的golang项目
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">运维开发，就是去写python，维护jumpserver源码
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">招运维，就是去给客户，部署jumpserver，以及运行过程中，出现问题，运维做技术支持，解决客户的问题。。
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608102903022.png"
	width="2919"
	height="1976"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608102903022_hu6793268836472641040.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608102903022_hu17524458799190202618.png 1024w"
	loading="lazy"
	
		alt="image-20220608102903022"
	
	
		class="gallery-image" 
		data-flex-grow="147"
		data-flex-basis="354px"
	
></p>
<h2 id="为什么要使用堡垒机">为什么要使用堡垒机
</h2><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg.png"
	width="514"
	height="308"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg_hu11099083650697893862.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg_hu11843173416429790565.png 1024w"
	loading="lazy"
	
		alt="clipImg"
	
	
		class="gallery-image" 
		data-flex-grow="166"
		data-flex-basis="400px"
	
></p>
<h2 id="跳板机和堡垒机">跳板机和堡垒机
</h2><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728391707917-4.png"
	width="595"
	height="437"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728391707917-4_hu2706523429896747279.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728391707917-4_hu714223037650410716.png 1024w"
	loading="lazy"
	
		alt="clipImg"
	
	
		class="gallery-image" 
		data-flex-grow="136"
		data-flex-basis="326px"
	
></p>
<hr>
<p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728391652797-2.png"
	width="408"
	height="535"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728391652797-2_hu7230364332697838918.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728391652797-2_hu1589091001191466750.png 1024w"
	loading="lazy"
	
		alt="clipImg"
	
	
		class="gallery-image" 
		data-flex-grow="76"
		data-flex-basis="183px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">为了细粒度的，监控运维，任意登录服务器操作的行为
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">可以责任制，防止无端背黑锅
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">也保证了服务器的安全
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="jumpserver基于ansible远程执行命令">jumpserver基于ansible远程执行命令
</h1><p><a class="link" href="https://docs.jumpserver.org/zh/v2/install/setup_by_fast/"  target="_blank" rel="noopener"
    >安装部署 - JumpServer 文档</a></p>
<p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728392506473-6.png"
	width="791"
	height="404"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728392506473-6_hu5452539620757854804.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728392506473-6_hu15840785112422100403.png 1024w"
	loading="lazy"
	
		alt="clipImg"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="469px"
	
></p>
<h1 id="项目架构图组件版本要求">项目架构图（组件版本要求）
</h1><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608110751371.png"
	width="2024"
	height="827"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608110751371_hu17155720649427366035.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608110751371_hu18325577767636018494.png 1024w"
	loading="lazy"
	
		alt="image-20220608110751371"
	
	
		class="gallery-image" 
		data-flex-grow="244"
		data-flex-basis="587px"
	
></p>
<p>这些每一个组件，当你部署好，运行好进程后， 需要整合起来，整合为一个可访问的统一入口</p>
<p>这个整合的和事佬是，是nginx。</p>
<p>请看nginx统一架构图，也是用户访问jumpserver的核心请求逻辑图。</p>
<p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728393674332-8.png"
	width="753"
	height="497"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728393674332-8_hu1303676924245024676.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/assets/clipImg-1728393674332-8_hu7496057477553427331.png 1024w"
	loading="lazy"
	
		alt="clipImg"
	
	
		class="gallery-image" 
		data-flex-grow="151"
		data-flex-basis="363px"
	
></p>
<h1 id="完整部署笔记">完整部署笔记
</h1><p>大项目，都是一个工程化开发结构，还是狠复杂的。</p>
<p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608112201869.png"
	width="2421"
	height="1562"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608112201869_hu14636918006457258480.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608112201869_hu4838084587519999732.png 1024w"
	loading="lazy"
	
		alt="image-20220608112201869"
	
	
		class="gallery-image" 
		data-flex-grow="154"
		data-flex-basis="371px"
	
></p>
<h2 id="服务器准备">服务器准备
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">准备好你的master-61机器，至少给它4G内存，因为 这里部署形式，是让前端，和后端在一台机器上，先不拆了。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">如果是你的官网应用，基于前后端分离开发模式，一定要分开多台机器的
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">master-61 运行堡垒机所有组件，5大组件
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">db-51  部署数据库mysql，和redis
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="mysqlredisdb-51数据库机器">mysql、redis（db-51，数据库机器）
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">重要，友情提醒</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">友情提示：</span><span class="n">mysql数据库密码请使用</span> <span class="s2">&#34;字母+数字&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">可以和老师配置的一样</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">用</span><span class="s2">&#34;lijin666&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">数据库密码连接，读取的是字符串类型</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">如果你的数据库密码是</span> <span class="s2">&#34;123456&#34;</span><span class="err">这样的纯数字，</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">在</span><span class="n">config</span><span class="o">.</span><span class="n">yml里面填入的DB_PASSWORD</span><span class="p">:</span> <span class="s2">&#34;123456&#34;</span> <span class="err">需要像这样，添加引号，否则报错。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">密码，复杂一点，数字</span><span class="o">+</span><span class="err">字母</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">2</span><span class="err">，</span> <span class="err">给大家准备的堡垒机</span> <span class="n">v2</span><span class="o">.</span><span class="mi">12</span><span class="err">版本，要求</span><span class="n">mysql版本大于等于5</span><span class="o">.</span><span class="mi">7</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 具体部署笔记</span>
</span></span><span class="line"><span class="cl"><span class="n">yum</span> <span class="o">-</span><span class="n">y</span> <span class="n">localinstall</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="o">.</span><span class="n">ustc</span><span class="o">.</span><span class="n">edu</span><span class="o">.</span><span class="n">cn</span><span class="o">/</span><span class="n">mysql</span><span class="o">-</span><span class="n">repo</span><span class="o">/</span><span class="n">mysql57</span><span class="o">-</span><span class="n">community</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">el7</span><span class="o">.</span><span class="n">rpm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sed</span>  <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;/gpgcheck=1/c gpgcheck=0&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">mysql</span><span class="o">-</span><span class="n">community</span><span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">yum</span> <span class="n">clean</span> <span class="n">all</span>
</span></span><span class="line"><span class="cl"><span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">mysql</span><span class="o">-</span><span class="n">community</span><span class="o">-</span><span class="n">server</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">初始化</span><span class="n">mysql数据</span>
</span></span><span class="line"><span class="cl"><span class="n">shell命令</span><span class="err">，修改</span><span class="n">mysql的启动脚本</span>
</span></span><span class="line"><span class="cl"><span class="n">mysql5</span><span class="o">.</span><span class="mi">7</span><span class="err">之后，默认初始化启动，会随机给你生成密码，你得去配置文件中找这个随机密码。</span>
</span></span><span class="line"><span class="cl"><span class="err">用如下命令，修改配置文件，可以让他默认别生成随机密码。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">[</span> <span class="o">!</span> <span class="s2">&#34;$(cat /usr/bin/mysqld_pre_systemd | grep -v ^\# | grep initialize-insecure )&#34;</span> <span class="p">];</span> <span class="n">then</span>
</span></span><span class="line"><span class="cl">    <span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&#34;s@--initialize @--initialize-insecure @g&#34;</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">mysqld_pre_systemd</span>
</span></span><span class="line"><span class="cl"><span class="n">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">启动</span>
</span></span><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">enable</span> <span class="n">mysqld</span>
</span></span><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">start</span> <span class="n">mysqld</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">检查进程，端口</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">~</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">~</span><span class="p">]</span><span class="c1">#netstat -tunlp|grep mysql</span>
</span></span><span class="line"><span class="cl"><span class="n">tcp6</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="p">:::</span><span class="mi">3306</span>                 <span class="p">:::</span><span class="o">*</span>                    <span class="n">LISTEN</span>      <span class="mi">2450</span><span class="o">/</span><span class="n">mysqld</span>         
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">~</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">~</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">~</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">~</span><span class="p">]</span><span class="c1">#ps -ef|grep mysql</span>
</span></span><span class="line"><span class="cl"><span class="n">mysql</span>      <span class="mi">2450</span>      <span class="mi">1</span>  <span class="mi">1</span> <span class="mi">11</span><span class="p">:</span><span class="mi">32</span> <span class="err">?</span>        <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">mysqld</span> <span class="o">--</span><span class="n">daemonize</span> <span class="o">--</span><span class="n">pid</span><span class="o">-</span><span class="n">file</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">mysqld</span><span class="o">/</span><span class="n">mysqld</span><span class="o">.</span><span class="n">pid</span>
</span></span><span class="line"><span class="cl"><span class="n">root</span>       <span class="mi">2484</span>   <span class="mi">1659</span>  <span class="mi">0</span> <span class="mi">11</span><span class="p">:</span><span class="mi">33</span> <span class="n">pts</span><span class="o">/</span><span class="mi">0</span>    <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">grep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="n">auto</span> <span class="n">mysql</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">尝试连接</span><span class="n">mysql</span><span class="err">，然后设置一个远程连接的用户，因为</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span><span class="err">机器需要用</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">~</span><span class="p">]</span><span class="c1">#mysql</span>
</span></span><span class="line"><span class="cl"><span class="n">Welcome</span> <span class="n">to</span> <span class="n">the</span> <span class="n">MySQL</span> <span class="n">monitor</span><span class="o">.</span>  <span class="n">Commands</span> <span class="n">end</span> <span class="n">with</span> <span class="p">;</span> <span class="ow">or</span> \<span class="n">g</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">Your</span> <span class="n">MySQL</span> <span class="n">connection</span> <span class="n">id</span> <span class="n">is</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">Server</span> <span class="n">version</span><span class="p">:</span> <span class="mf">5.7</span><span class="o">.</span><span class="mi">38</span> <span class="n">MySQL</span> <span class="n">Community</span> <span class="n">Server</span> <span class="p">(</span><span class="n">GPL</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Copyright</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2022</span><span class="p">,</span> <span class="n">Oracle</span> <span class="ow">and</span><span class="o">/</span><span class="ow">or</span> <span class="n">its</span> <span class="n">affiliates</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Oracle</span> <span class="n">is</span> <span class="n">a</span> <span class="n">registered</span> <span class="n">trademark</span> <span class="n">of</span> <span class="n">Oracle</span> <span class="n">Corporation</span> <span class="ow">and</span><span class="o">/</span><span class="ow">or</span> <span class="n">its</span>
</span></span><span class="line"><span class="cl"><span class="n">affiliates</span><span class="o">.</span> <span class="n">Other</span> <span class="n">names</span> <span class="n">may</span> <span class="n">be</span> <span class="n">trademarks</span> <span class="n">of</span> <span class="n">their</span> <span class="n">respective</span>
</span></span><span class="line"><span class="cl"><span class="n">owners</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Type</span> <span class="s1">&#39;help;&#39;</span> <span class="ow">or</span> <span class="s1">&#39;\h&#39;</span> <span class="k">for</span> <span class="n">help</span><span class="o">.</span> <span class="n">Type</span> <span class="s1">&#39;\c&#39;</span> <span class="n">to</span> <span class="n">clear</span> <span class="n">the</span> <span class="n">current</span> <span class="n">input</span> <span class="n">statement</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># 创建数据库，用于堡垒机写入数据表信息</span>
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">database</span> <span class="n">jumpserver</span> <span class="n">default</span> <span class="n">charset</span> <span class="s1">&#39;utf8&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span> <span class="p">(</span><span class="mf">0.00</span> <span class="n">sec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># 设置弱密码参数，默认密码难度限制较大，数字，字母，特殊符号。</span>
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">set</span> <span class="n">global</span> <span class="n">validate_password_policy</span><span class="o">=</span><span class="n">LOW</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mf">0.00</span> <span class="n">sec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># 创建用户，jumpserver 以及密码，待会用于远程连接</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">user</span> <span class="s1">&#39;jumpserver&#39;</span><span class="err">@</span><span class="s1">&#39;%&#39;</span> <span class="n">identified</span> <span class="n">by</span> <span class="s1">&#39;linux0224&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mf">0.00</span> <span class="n">sec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 用户授予远程连接权限</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">grant</span> <span class="n">all</span> <span class="n">on</span> <span class="n">jumpserver</span><span class="o">.*</span> <span class="n">to</span> <span class="s1">&#39;jumpserver&#39;</span><span class="err">@</span><span class="s1">&#39;%&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mf">0.00</span> <span class="n">sec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">flush</span> <span class="n">privileges</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mf">0.00</span> <span class="n">sec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">到这里，数据库</span><span class="n">mysql5</span><span class="o">.</span><span class="mi">7</span><span class="err">就配置完毕了</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="redis内存型数据库">redis内存型数据库
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">mysql</span> <span class="err">磁盘性数据库存储网站的</span> <span class="err">冷数据，读取不频繁的</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">redis</span> <span class="err">数据存内存里。存储网站热数据，如用户信息等，用户的</span><span class="n">session身份保持信息等</span><span class="err">。</span> 
</span></span><span class="line"><span class="cl"><span class="err">组件连接的信息等</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">要求版本大于</span><span class="mf">6.0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">编译安装，准备编译环境，以及</span><span class="n">redis源码</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">yum</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">epel</span><span class="o">-</span><span class="n">release</span> <span class="n">wget</span> <span class="n">make</span> <span class="n">gcc</span><span class="o">-</span><span class="n">c</span><span class="o">++</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 6.2.4版本</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="n">opt</span> <span class="p">;</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mf">4.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#tar -xf redis-6.2.4.tar.gz </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">进入源代码目录，编译安装即可，注意可以指定安装的路径参数</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="n">make</span> <span class="o">&amp;&amp;</span> <span class="n">make</span> <span class="n">install</span> <span class="n">PREFIX</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">redis</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">检查你的</span><span class="n">redis安装情况</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#cd /usr/local/redis/</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">redis</span><span class="p">]</span><span class="c1">#ls</span>
</span></span><span class="line"><span class="cl"><span class="n">bin</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">redis</span><span class="p">]</span><span class="c1">#ls bin</span>
</span></span><span class="line"><span class="cl"><span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span>  <span class="n">redis</span><span class="o">-</span><span class="n">check</span><span class="o">-</span><span class="n">aof</span>  <span class="n">redis</span><span class="o">-</span><span class="n">check</span><span class="o">-</span><span class="n">rdb</span>  <span class="n">redis</span><span class="o">-</span><span class="n">cli</span>  <span class="n">redis</span><span class="o">-</span><span class="n">sentinel</span>  <span class="n">redis</span><span class="o">-</span><span class="n">server</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">需要你自己添加</span><span class="n">PATH变量</span><span class="err">，方可直接使用。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#tail -2 /etc/profile</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">PATH</span><span class="o">=$</span><span class="n">PATH</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">修改配置文件的参数，设定</span><span class="n">redis数据库的连接信息</span><span class="err">，以及密码</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 拷贝配置文件</span>
</span></span><span class="line"><span class="cl"><span class="n">cp</span> <span class="n">redis</span><span class="o">.</span><span class="n">conf</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 允许redis在任意地址可访问</span>
</span></span><span class="line"><span class="cl"><span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&#34;s/bind 127.0.0.1/bind 0.0.0.0/g&#34;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 让redis以守护进程，在后台运行</span>
</span></span><span class="line"><span class="cl"><span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&#34;s/daemonize no/daemonize yes/g&#34;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 设置redis的内存性参数，内存缓存算法</span>
</span></span><span class="line"><span class="cl"><span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&#34;561i maxmemory-policy allkeys-lru&#34;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 设置redis的连接密码requirepass设置密码的，后面写密码</span>
</span></span><span class="line"><span class="cl"><span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&#34;481i requirepass linux0224&#34;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">验证你的配置，是否生效</span>
</span></span><span class="line"><span class="cl"><span class="n">grep</span> <span class="o">-</span><span class="n">Ev</span> <span class="s1">&#39;^#|^$&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">conf</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">验证你的修改操作</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#grep -Ev &#39;^#|^$&#39; /etc/redis.conf  | grep -E &#39;(bind|require|daemonize)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">bind</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span> <span class="o">-</span><span class="p">::</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">daemonize</span> <span class="n">yes</span>
</span></span><span class="line"><span class="cl"><span class="n">requirepass</span> <span class="n">linux0224</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">由于是编译安装，默认没有</span><span class="n">systemctl的管理脚本</span><span class="err">，可以自己写一个即可</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cat</span> <span class="o">&gt;/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">service</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">Unit</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">Description</span><span class="o">=</span><span class="n">Redis</span> <span class="n">persistent</span> <span class="n">key</span><span class="o">-</span><span class="n">value</span> <span class="n">database</span>
</span></span><span class="line"><span class="cl"><span class="n">After</span><span class="o">=</span><span class="n">network</span><span class="o">.</span><span class="n">target</span>
</span></span><span class="line"><span class="cl"><span class="n">After</span><span class="o">=</span><span class="n">network</span><span class="o">-</span><span class="n">online</span><span class="o">.</span><span class="n">target</span>
</span></span><span class="line"><span class="cl"><span class="n">Wants</span><span class="o">=</span><span class="n">network</span><span class="o">-</span><span class="n">online</span><span class="o">.</span><span class="n">target</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">Service</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">Type</span><span class="o">=</span><span class="n">forking</span>
</span></span><span class="line"><span class="cl"><span class="n">PIDFile</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">redis_6379</span><span class="o">.</span><span class="n">pid</span>
</span></span><span class="line"><span class="cl"><span class="n">ExecStart</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">server</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl"><span class="n">ExecReload</span><span class="o">=/</span><span class="n">bin</span><span class="o">/</span><span class="n">kill</span> <span class="o">-</span><span class="n">s</span> <span class="n">HUP</span> <span class="o">$</span><span class="n">MAINPID</span>
</span></span><span class="line"><span class="cl"><span class="n">ExecStop</span><span class="o">=/</span><span class="n">bin</span><span class="o">/</span><span class="n">kill</span> <span class="o">-</span><span class="n">s</span> <span class="n">QUIT</span> <span class="o">$</span><span class="n">MAINPID</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">Install</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">WantedBy</span><span class="o">=</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="o">.</span><span class="n">target</span>
</span></span><span class="line"><span class="cl"><span class="n">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">可以用</span><span class="n">systemctl去管理了</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 启动redis</span>
</span></span><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">enable</span> <span class="n">redis</span>
</span></span><span class="line"><span class="cl"><span class="n">systemctl</span> <span class="n">start</span> <span class="n">redis</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">确保</span><span class="n">redis运行中</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#ps -ef|grep redis</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">root</span>       <span class="mi">7009</span>      <span class="mi">1</span>  <span class="mi">0</span> <span class="mi">11</span><span class="p">:</span><span class="mi">50</span> <span class="err">?</span>        <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">server</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">6379</span>
</span></span><span class="line"><span class="cl"><span class="n">root</span>       <span class="mi">7015</span>   <span class="mi">1659</span>  <span class="mi">0</span> <span class="mi">11</span><span class="p">:</span><span class="mi">50</span> <span class="n">pts</span><span class="o">/</span><span class="mi">0</span>    <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">grep</span> <span class="o">--</span><span class="n">color</span><span class="o">=</span><span class="n">auto</span> <span class="n">redis</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#netstat -tunlp|grep redis</span>
</span></span><span class="line"><span class="cl"><span class="n">tcp</span>        <span class="mi">0</span>      <span class="mi">0</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">6379</span>            <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="o">*</span>               <span class="n">LISTEN</span>      <span class="mi">7009</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">server</span> <span class="mi">0</span> 
</span></span><span class="line"><span class="cl"><span class="n">tcp6</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="p">::</span><span class="mi">1</span><span class="p">:</span><span class="mi">6379</span>                <span class="p">:::</span><span class="o">*</span>                    <span class="n">LISTEN</span>      <span class="mi">7009</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">server</span> <span class="mi">0</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">本地连接</span><span class="n">redis测试</span><span class="err">，查看密码是否好用</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#redis-cli </span>
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> <span class="n">ping</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="n">NOAUTH</span> <span class="n">Authentication</span> <span class="n">required</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> <span class="n">auth</span> <span class="n">linux0224</span>
</span></span><span class="line"><span class="cl"><span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> <span class="n">ping</span>
</span></span><span class="line"><span class="cl"><span class="n">PONG</span>
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> <span class="n">exit</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">## master-61去远程连接redis</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#redis-cli  -h 172.16.1.51</span>
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> <span class="n">ping</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="n">NOAUTH</span> <span class="n">Authentication</span> <span class="n">required</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> <span class="n">auth</span> <span class="n">linunx0224</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="n">WRONGPASS</span> <span class="n">invalid</span> <span class="n">username</span><span class="o">-</span><span class="n">password</span> <span class="n">pair</span> <span class="ow">or</span> <span class="n">user</span> <span class="n">is</span> <span class="n">disabled</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> <span class="n">auth</span> <span class="n">linux0224</span>
</span></span><span class="line"><span class="cl"><span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> <span class="n">ping</span>
</span></span><span class="line"><span class="cl"><span class="n">PONG</span>
</span></span><span class="line"><span class="cl"><span class="mf">172.16</span><span class="o">.</span><span class="mf">1.51</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> <span class="n">exit</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">## 本地连接，远程连接，密码认证，ping pong通了</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">db</span><span class="o">-</span><span class="mi">51</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="mf">6.2</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span><span class="c1">#</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608121231232.png"
	width="1974"
	height="1524"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608121231232_hu6322492951874773327.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608121231232_hu5410532574535857443.png 1024w"
	loading="lazy"
	
		alt="image-20220608121231232"
	
	
		class="gallery-image" 
		data-flex-grow="129"
		data-flex-basis="310px"
	
></p>
<h2 id="core核心堡垒机后端服务内存至少4g其他服务起不来">core(核心堡垒机后端服务)（内存至少4G，其他服务起不来）
</h2><p>光jumpserver核心core程序，至少用到2G内存。</p>
<p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608121255049.png"
	width="1984"
	height="1533"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608121255049_hu1953534778258233770.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608121255049_hu5192705751417641464.png 1024w"
	loading="lazy"
	
		alt="image-20220608121255049"
	
	
		class="gallery-image" 
		data-flex-grow="129"
		data-flex-basis="310px"
	
></p>
<h3 id="基础环境安装">基础环境安装
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">先确保环境正确，基础环境部署。</span>
</span></span><span class="line"><span class="cl"><span class="err">先恢复</span><span class="n">master61机器</span><span class="err">，注意，做好快照。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">从端口来看，这个机器是干净的。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#netstat -tunlp</span>
</span></span><span class="line"><span class="cl"><span class="n">Active</span> <span class="n">Internet</span> <span class="n">connections</span> <span class="p">(</span><span class="n">only</span> <span class="n">servers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Proto</span> <span class="n">Recv</span><span class="o">-</span><span class="n">Q</span> <span class="n">Send</span><span class="o">-</span><span class="n">Q</span> <span class="n">Local</span> <span class="n">Address</span>           <span class="n">Foreign</span> <span class="n">Address</span>         <span class="n">State</span>       <span class="n">PID</span><span class="o">/</span><span class="n">Program</span> <span class="n">name</span>    
</span></span><span class="line"><span class="cl"><span class="n">tcp</span>        <span class="mi">0</span>      <span class="mi">0</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">22</span>              <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="o">*</span>               <span class="n">LISTEN</span>      <span class="mi">893</span><span class="o">/</span><span class="n">sshd</span>            
</span></span><span class="line"><span class="cl"><span class="n">tcp</span>        <span class="mi">0</span>      <span class="mi">0</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">25</span>            <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="o">*</span>               <span class="n">LISTEN</span>      <span class="mi">1151</span><span class="o">/</span><span class="n">master</span>         
</span></span><span class="line"><span class="cl"><span class="n">tcp6</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="p">:::</span><span class="mi">22</span>                   <span class="p">:::</span><span class="o">*</span>                    <span class="n">LISTEN</span>      <span class="mi">893</span><span class="o">/</span><span class="n">sshd</span>            
</span></span><span class="line"><span class="cl"><span class="n">tcp6</span>       <span class="mi">0</span>      <span class="mi">0</span> <span class="p">::</span><span class="mi">1</span><span class="p">:</span><span class="mi">25</span>                  <span class="p">:::</span><span class="o">*</span>                    <span class="n">LISTEN</span>      <span class="mi">1151</span><span class="o">/</span><span class="n">master</span>         
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">检查防火墙</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">yum源</span><span class="err">，基础环境部署</span>
</span></span><span class="line"><span class="cl"><span class="n">wget</span> <span class="o">-</span><span class="n">O</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">CentOS</span><span class="o">-</span><span class="n">Base</span><span class="o">.</span><span class="n">repo</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="o">.</span><span class="n">aliyun</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">repo</span><span class="o">/</span><span class="n">Centos</span><span class="o">-</span><span class="mf">7.</span><span class="n">repo</span>
</span></span><span class="line"><span class="cl"><span class="n">wget</span> <span class="o">-</span><span class="n">O</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">yum</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">epel</span><span class="o">.</span><span class="n">repo</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="o">.</span><span class="n">aliyun</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">repo</span><span class="o">/</span><span class="n">epel</span><span class="o">-</span><span class="mf">7.</span><span class="n">repo</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 一是，安装基础软件</span>
</span></span><span class="line"><span class="cl"><span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">bash</span><span class="o">-</span><span class="n">completion</span> <span class="n">vim</span> <span class="n">lrzsz</span> <span class="n">wget</span> <span class="n">expect</span> <span class="n">net</span><span class="o">-</span><span class="n">tools</span> <span class="n">nc</span> <span class="n">nmap</span> <span class="n">tree</span> <span class="n">dos2unix</span> <span class="n">htop</span> <span class="n">iftop</span> <span class="n">iotop</span> <span class="n">unzip</span> <span class="n">telnet</span> <span class="n">sl</span> <span class="n">psmisc</span> <span class="n">nethogs</span> <span class="n">glances</span> <span class="n">bc</span> <span class="n">ntpdate</span>  <span class="n">openldap</span><span class="o">-</span><span class="n">devel</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span><span class="err">第一个里程：需要部署跳板机依赖软件，重要</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 二是，安装python程序，必须的一些基础依赖。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">yum</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">git</span> <span class="n">python</span><span class="o">-</span><span class="n">pip</span>  <span class="n">gcc</span> <span class="n">automake</span> <span class="n">autoconf</span> <span class="n">python</span><span class="o">-</span><span class="n">devel</span> <span class="n">vim</span> <span class="n">sshpass</span> <span class="n">lrzsz</span> <span class="n">readline</span><span class="o">-</span><span class="n">devel</span>  <span class="n">zlib</span> <span class="n">zlib</span><span class="o">-</span><span class="n">devel</span> <span class="n">openssl</span> <span class="n">openssl</span><span class="o">-</span><span class="n">devel</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">设置</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span><span class="err">机器的系统编码环境，支持中文</span>
</span></span><span class="line"><span class="cl"><span class="n">localedef</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">f</span> <span class="n">UTF</span><span class="o">-</span><span class="mi">8</span> <span class="o">-</span><span class="n">i</span> <span class="n">zh_CN</span> <span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 设置操作系统所有的语言环境，改为中文utf8编码</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">LC_ALL</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">查看编码情况</span>
</span></span><span class="line"><span class="cl"><span class="err">使用</span><span class="n">locale命令</span><span class="err">，查看系统本地所有编码的变量</span>
</span></span><span class="line"><span class="cl"><span class="err">需要你切换系统的中英文支持。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#locale</span>
</span></span><span class="line"><span class="cl"><span class="n">LANG</span><span class="o">=</span><span class="n">en_US</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_CTYPE</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_NUMERIC</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_TIME</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_COLLATE</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_MONETARY</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_MESSAGES</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_PAPER</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_NAME</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_ADDRESS</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_TELEPHONE</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_MEASUREMENT</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_IDENTIFICATION</span><span class="o">=</span><span class="s2">&#34;zh_CN.UTF-8&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">LC_ALL</span><span class="o">=</span><span class="n">zh_CN</span><span class="o">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 这是一个python3开发的源代码，jumpserver，因此需要配置python3环境，咱们是编译安装，因为有版本要求。</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 编译安装，python是可以处理ssl加密，因此你的底层需要安装openssl基础环境</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 下载安装python3源代码，部署python这一块，会需要用到一些python的环境知识，认真听，稍微有点难度。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 1. 下载jumpserver后端核心源码</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mkdir</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span>
</span></span><span class="line"><span class="cl"><span class="n">wget</span> <span class="o">-</span><span class="n">O</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">/</span><span class="n">archive</span><span class="o">/</span><span class="n">refs</span><span class="o">/</span><span class="n">tags</span><span class="o">/</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2. 解压缩源代码，安装后端源码，运行所需的linux环境依赖，rpm包，人家给提供好了</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --strip-components 1 参数意思是，</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="n">opt</span> <span class="p">;</span> <span class="n">tar</span> <span class="o">-</span><span class="n">xf</span> <span class="n">jumpserver</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span> <span class="o">--</span><span class="n">strip</span><span class="o">-</span><span class="n">components</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="o">---------------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 3.检查解压的源码（这就是python的web框架，django的一堆源代码，都是py文件）</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 其实就是一堆py代码，和sh脚本，这个源码是飞致云的运维开发，写的程序</span>
</span></span><span class="line"><span class="cl"><span class="c1">#  纯开发，纯后端开发，是写业务代码，如电商后台，员工管理系统后台，医疗系统后台</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    管理的纯业务的员工数据，商业数据。</span>
</span></span><span class="line"><span class="cl"><span class="o">------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1">#  运维开发，写代码，写平台，数据库管理的是机器的信息，如资产管理平台， 代码发布平台，容器管理平台</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ansible自动化调度平台。运维开发，通过运维技术+开发技术，管理服务器，等资产信息。</span>
</span></span><span class="line"><span class="cl"><span class="c1"># </span>
</span></span><span class="line"><span class="cl"><span class="o">---------------------------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="p">]</span><span class="c1">#ls</span>
</span></span><span class="line"><span class="cl"><span class="n">apps</span>                <span class="n">data</span>        <span class="n">docs</span>           <span class="n">jms</span>      <span class="n">logs</span>          <span class="n">README</span><span class="o">.</span><span class="n">md</span>     <span class="n">run_server</span><span class="o">.</span><span class="n">py</span>  <span class="n">utils</span>
</span></span><span class="line"><span class="cl"><span class="n">config_example</span><span class="o">.</span><span class="n">yml</span>  <span class="n">Dockerfile</span>  <span class="n">entrypoint</span><span class="o">.</span><span class="n">sh</span>  <span class="n">LICENSE</span>  <span class="n">README_EN</span><span class="o">.</span><span class="n">md</span>  <span class="n">requirements</span>  <span class="n">tmp</span>            <span class="n">Vagrantfile</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3. jumpserver源码，给你提供了一堆rpm包，需要你去安装方可运行，</span>
</span></span><span class="line"><span class="cl"><span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="o">$</span><span class="p">(</span><span class="n">cat</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">/</span><span class="n">requirements</span><span class="o">/</span><span class="n">rpm_requirements</span><span class="o">.</span><span class="n">txt</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="python36开发环境安装">python3.6开发环境安装
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">当你以后去维护</span><span class="n">python的产品</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">目前市面上有</span><span class="mi">2</span><span class="err">个版本</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="n">python2的版本</span><span class="err">，以及不再维护了，但是有老企业在用</span><span class="p">(</span><span class="n">linux系统默认很多工具用的是python2</span><span class="err">，如</span><span class="n">yum工具</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="p">]</span><span class="c1">#python -V</span>
</span></span><span class="line"><span class="cl"><span class="n">Python</span> <span class="mf">2.7</span><span class="o">.</span><span class="mi">5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="n">python3的版本</span><span class="err">，主流版本</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">要注意的是，同时保留</span><span class="n">python2</span><span class="err">，和</span><span class="n">python3</span><span class="err">，不要乱改。</span>
</span></span><span class="line"><span class="cl"><span class="err">添加到</span><span class="n">PATH</span><span class="err">，让</span><span class="mi">2</span><span class="err">个版本共存即可。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="err">先安装</span><span class="n">python3的编译环境</span><span class="err">，注意整理</span><span class="n">python的包</span><span class="err">，是不带</span><span class="mi">3</span><span class="err">这个数字的！！</span>
</span></span><span class="line"><span class="cl"><span class="n">yum</span> <span class="n">install</span> <span class="n">gcc</span> <span class="n">patch</span> <span class="n">libffi</span><span class="o">-</span><span class="n">devel</span> <span class="n">python</span><span class="o">-</span><span class="n">devel</span>  <span class="n">zlib</span><span class="o">-</span><span class="n">devel</span> <span class="n">bzip2</span><span class="o">-</span><span class="n">devel</span> <span class="n">openssl</span><span class="o">-</span><span class="n">devel</span> <span class="n">ncurses</span><span class="o">-</span><span class="n">devel</span> <span class="n">sqlite</span><span class="o">-</span><span class="n">devel</span> <span class="n">readline</span><span class="o">-</span><span class="n">devel</span> <span class="n">tk</span><span class="o">-</span><span class="n">devel</span> <span class="n">gdbm</span><span class="o">-</span><span class="n">devel</span> <span class="n">db4</span><span class="o">-</span><span class="n">devel</span> <span class="n">libpcap</span><span class="o">-</span><span class="n">devel</span> <span class="n">xz</span><span class="o">-</span><span class="n">devel</span> <span class="o">-</span><span class="n">y</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">5.</span> <span class="err">下载</span><span class="n">python3源码</span><span class="err">，编译且安装</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 使用自建的yum仓库即可。</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 确保你的编译过程，没有errorr，看好日志</span>
</span></span><span class="line"><span class="cl"><span class="c1"># python语言是由C语言开发而来。。。它也叫做Cpython。。没想到吧。。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="n">opt</span> <span class="o">&amp;&amp;</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">ftp</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="mf">3.6</span><span class="o">.</span><span class="mi">9</span><span class="o">/</span><span class="n">Python</span><span class="o">-</span><span class="mf">3.6</span><span class="o">.</span><span class="mf">9.</span><span class="n">tgz</span>
</span></span><span class="line"><span class="cl"><span class="n">tar</span> <span class="o">-</span><span class="n">zxf</span> <span class="n">Python</span><span class="o">-</span><span class="mf">3.6</span><span class="o">.</span><span class="mf">9.</span><span class="n">tgz</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="n">Python</span><span class="o">-</span><span class="mf">3.6</span><span class="o">.</span><span class="mi">9</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="o">./</span><span class="n">configure</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">python369</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">make</span> <span class="o">&amp;&amp;</span> <span class="n">make</span> <span class="n">install</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">6.</span><span class="err">看到如下日志，你的</span><span class="n">python3才是正常的</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Collecting</span> <span class="n">setuptools</span>
</span></span><span class="line"><span class="cl"><span class="n">Collecting</span> <span class="n">pip</span>
</span></span><span class="line"><span class="cl"><span class="n">Installing</span> <span class="n">collected</span> <span class="n">packages</span><span class="p">:</span> <span class="n">setuptools</span><span class="p">,</span> <span class="n">pip</span>
</span></span><span class="line"><span class="cl"><span class="n">Successfully</span> <span class="n">installed</span> <span class="n">pip</span><span class="o">-</span><span class="mf">18.1</span> <span class="n">setuptools</span><span class="o">-</span><span class="mf">40.6</span><span class="o">.</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">检查</span><span class="n">python3的环境如下</span><span class="err">，添加到</span><span class="n">PATH变量中</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">python369</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#tail -2 /etc/profile</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 添加python3的PATH</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">PATH</span><span class="o">=$</span><span class="n">PATH</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">python369</span><span class="o">/</span><span class="n">bin</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">python369</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#source /etc/profile</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">7.</span><span class="err">检查，确保如下</span><span class="mi">2</span><span class="err">个命令可以正确执行，你的</span><span class="n">python3环境才是对的</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 这个是python3的解释器，用于执行*.py代码的。</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#python3 -V</span>
</span></span><span class="line"><span class="cl"><span class="n">Python</span> <span class="mf">3.6</span><span class="o">.</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 这是管理python程序的模块依赖包的</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 这么去理解</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    yum是给centos安装rpm包依赖的。</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    pip3命令是给python3，给python项目，安装项目所需的依赖的。</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 它俩是2个 东西</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#pip3 -V</span>
</span></span><span class="line"><span class="cl"><span class="n">pip</span> <span class="mf">18.1</span> <span class="n">from</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">python369</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pip</span> <span class="p">(</span><span class="n">python</span> <span class="mf">3.6</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="补充设置pip3的下载源豆瓣源加速模块下载">补充：设置pip3的下载源，豆瓣源，加速模块下载
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># 在用户家目录下，生成一个全局的 .pip.conf配置文件而已。
</span></span><span class="line"><span class="cl"># 就是生成一个文件而已。然后pip3 install  xxx模块的时候，会使用如下这个地址
</span></span><span class="line"><span class="cl"># 就和你配置yum源一个意思。。。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 创建文件夹
</span></span><span class="line"><span class="cl">mkdir ~/.pip
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 创建配置文件
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 ~]#cat ~/.pip/pip.conf 
</span></span><span class="line"><span class="cl">[global]
</span></span><span class="line"><span class="cl">index-url=https://pypi.douban.com/simple
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608151904693.png"
	width="2470"
	height="1138"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608151904693_hu7312452213697102136.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608151904693_hu5913028319370891541.png 1024w"
	loading="lazy"
	
		alt="image-20220608151904693"
	
	
		class="gallery-image" 
		data-flex-grow="217"
		data-flex-basis="520px"
	
></p>
<h3 id="python3的虚拟环境安装虚拟环境原理就是在修改path变量">python3的虚拟环境安装（虚拟环境原理就是在修改PATH变量）
</h3><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608145753469.png"
	width="3118"
	height="5000"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608145753469_hu13275028518875436613.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608145753469_hu7910464864310149612.png 1024w"
	loading="lazy"
	
		alt="image-20220608145753469"
	
	
		class="gallery-image" 
		data-flex-grow="62"
		data-flex-basis="149px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">当前机器上，存在一个</span><span class="n">python3的环境</span><span class="err">，绝对路径在</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#which python3</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">python369</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">python3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 具体的演示如下</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">创建虚拟环境（其实就是又下载了一个</span><span class="n">python3解释器</span><span class="err">，而已，你理解是本体解释器的一个分身即可。）</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 基于python3命令 指定用venv这个模块功能，下载安装一个解释器路径到   /opt/venv_py3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="n">opt</span> <span class="o">&amp;&amp;</span> <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">venv</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">venv_py3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">演示，物理解释器的环境信息，以及虚拟环境的解释器信息</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="err">查看【物理解释器】本体的模块信息</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#which pip3</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">python369</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">pip3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">查看模块列表</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#pip3 list</span>
</span></span><span class="line"><span class="cl"><span class="n">Package</span>    <span class="n">Version</span>
</span></span><span class="line"><span class="cl"><span class="o">----------</span> <span class="o">-------</span>
</span></span><span class="line"><span class="cl"><span class="n">pip</span>        <span class="mf">18.1</span>   
</span></span><span class="line"><span class="cl"><span class="n">setuptools</span> <span class="mf">40.6</span><span class="o">.</span><span class="mi">2</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">随便装一个模块，再查看模块列表</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#pip3 install requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#pip3 list</span>
</span></span><span class="line"><span class="cl"><span class="n">Package</span>            <span class="n">Version</span>    
</span></span><span class="line"><span class="cl"><span class="o">------------------</span> <span class="o">-----------</span>
</span></span><span class="line"><span class="cl"><span class="n">certifi</span>            <span class="mf">2022.5</span><span class="o">.</span><span class="mf">18.1</span>
</span></span><span class="line"><span class="cl"><span class="n">charset</span><span class="o">-</span><span class="n">normalizer</span> <span class="mf">2.0</span><span class="o">.</span><span class="mi">12</span>     
</span></span><span class="line"><span class="cl"><span class="n">idna</span>               <span class="mf">3.3</span>        
</span></span><span class="line"><span class="cl"><span class="n">pip</span>                <span class="mf">18.1</span>       
</span></span><span class="line"><span class="cl"><span class="n">requests</span>           <span class="mf">2.27</span><span class="o">.</span><span class="mi">1</span>     
</span></span><span class="line"><span class="cl"><span class="n">setuptools</span>         <span class="mf">40.6</span><span class="o">.</span><span class="mi">2</span>     
</span></span><span class="line"><span class="cl"><span class="n">urllib3</span>            <span class="mf">1.26</span><span class="o">.</span><span class="mi">9</span>    
</span></span><span class="line"><span class="cl"><span class="err">￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥</span>
</span></span><span class="line"><span class="cl"><span class="o">------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">激活虚拟环境，安装</span><span class="n">jumpserver后端所需的python依赖</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#source /opt/venv_py3/bin/activate</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#which pip3</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">venv_py3</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">pip3</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">查看当前</span><span class="n">python3解释器的模块列表</span>
</span></span><span class="line"><span class="cl"><span class="err">￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#pip3 list</span>
</span></span><span class="line"><span class="cl"><span class="n">Package</span>    <span class="n">Version</span>
</span></span><span class="line"><span class="cl"><span class="o">----------</span> <span class="o">-------</span>
</span></span><span class="line"><span class="cl"><span class="n">pip</span>        <span class="mf">18.1</span>   
</span></span><span class="line"><span class="cl"><span class="n">setuptools</span> <span class="mf">40.6</span><span class="o">.</span><span class="mi">2</span> 
</span></span><span class="line"><span class="cl"><span class="err">￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥￥</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">能看明白，此时基于虚拟环境，管理了一个新的解释器模块依赖</span>
</span></span><span class="line"><span class="cl"><span class="err">和物理解释器的模块信息，是分开的，</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>说到这里，就是已经装好了一个虚拟环境</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/opt/venv_py3/ 这个路径的解释器
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="为什么激活虚拟环境后解释器用which查看的路径就变了">为什么激活虚拟环境后，解释器用which查看的路径就变了。
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">很简单，因为它帮你修改了PATH
</span></span><span class="line"><span class="cl">PATH有加载顺序，从左到右。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">1. 查看虚拟环境下的PATH信息
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt]#echo $PATH
</span></span><span class="line"><span class="cl">/opt/venv_py3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin:/opt/python369/bin
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt]#
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2. 退出虚拟环境后再看
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt]#deactivate 
</span></span><span class="line"><span class="cl">[root@master-61 /opt]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt]#echo $PATH
</span></span><span class="line"><span class="cl">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin:/opt/python369/bin
</span></span><span class="line"><span class="cl">[root@master-61 /opt]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt]#which pip3
</span></span><span class="line"><span class="cl">/opt/python369/bin/pip3
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608151229207.png"
	width="3084"
	height="1808"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608151229207_hu12821199806607803586.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608151229207_hu7118598185256909271.png 1024w"
	loading="lazy"
	
		alt="image-20220608151229207"
	
	
		class="gallery-image" 
		data-flex-grow="170"
		data-flex-basis="409px"
	
></p>
<h3 id="安装jumpserver后端所需的python依赖">安装jumpserver后端所需的python依赖
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mf">1.</span><span class="err">确保要激活虚拟环境</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">找到项目中的，项目依赖文件，这是每一个</span><span class="n">python开发者</span><span class="err">，必然会设置的一个文件，方便运维去部署这些依赖模块。</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">/</span><span class="n">requirements</span><span class="p">]</span><span class="c1">#ls /opt/jumpserver-v2.12.0/requirements/requirements.txt </span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">/</span><span class="n">requirements</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">先查看当前的虚拟环境下的依赖列表</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#pip3 list</span>
</span></span><span class="line"><span class="cl"><span class="n">Package</span>    <span class="n">Version</span>
</span></span><span class="line"><span class="cl"><span class="o">----------</span> <span class="o">-------</span>
</span></span><span class="line"><span class="cl"><span class="n">pip</span>        <span class="mf">18.1</span>   
</span></span><span class="line"><span class="cl"><span class="n">setuptools</span> <span class="mf">40.6</span><span class="o">.</span><span class="mi">2</span> 
</span></span><span class="line"><span class="cl"><span class="n">You</span> <span class="n">are</span> <span class="n">using</span> <span class="n">pip</span> <span class="n">version</span> <span class="mf">18.1</span><span class="p">,</span> <span class="n">however</span> <span class="n">version</span> <span class="mf">21.3</span><span class="o">.</span><span class="mi">1</span> <span class="n">is</span> <span class="n">available</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">You</span> <span class="n">should</span> <span class="n">consider</span> <span class="n">upgrading</span> <span class="n">via</span> <span class="n">the</span> <span class="s1">&#39;pip install --upgrade pip&#39;</span> <span class="n">command</span><span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="err">安装这些模块依赖（注意，使用豆瓣源去下载，否则让你怀疑人生）</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#pip3 install -r /opt/jumpserver-v2.12.0/requirements/requirements.txt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">这个</span><span class="n">python模块</span><span class="err">，要么全部成功，要么全部会失败。</span>
</span></span><span class="line"><span class="cl"><span class="err">注意别报错即可。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">别出现</span><span class="n">error</span><span class="err">，否则</span><span class="n">pip3命令会立即终止的</span><span class="err">，然后看报错，解决报错即可。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="err">查看模块依赖（依然是虚拟环境下的模块依赖）</span>
</span></span><span class="line"><span class="cl"><span class="err">差不多有</span><span class="mi">198</span><span class="err">行模块</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#pip3 list |wc -l</span>
</span></span><span class="line"><span class="cl"><span class="mi">198</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">5.</span> <span class="err">可以退出虚拟环境，对比着物理环境理解下，看下区别。</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="再次确认物理环境和虚拟环境的区别">再次确认，物理环境，和虚拟环境的区别
</h3><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/Untitled-2022-02-25-1054.excalidraw.png"
	width="3932"
	height="5000"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/Untitled-2022-02-25-1054.excalidraw_hu15845691564622465064.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/Untitled-2022-02-25-1054.excalidraw_hu15659621257512357684.png 1024w"
	loading="lazy"
	
		alt="Untitled-2022-02-25-1054.excalidraw"
	
	
		class="gallery-image" 
		data-flex-grow="78"
		data-flex-basis="188px"
	
></p>
<h3 id="解决pip版本太低的问题升级即可">解决pip版本太低的问题，升级即可
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="p">(</span><span class="n">venv_py3</span><span class="p">)</span> <span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">~</span><span class="p">]</span><span class="c1">#pip install --upgrade pip</span>
</span></span><span class="line"><span class="cl"><span class="n">Looking</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pypi</span><span class="o">.</span><span class="n">douban</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">simple</span>
</span></span><span class="line"><span class="cl"><span class="n">Collecting</span> <span class="n">pip</span>
</span></span><span class="line"><span class="cl">  <span class="n">Downloading</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pypi</span><span class="o">.</span><span class="n">doubanio</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">a4</span><span class="o">/</span><span class="mi">6</span><span class="n">d</span><span class="o">/</span><span class="mi">6463</span><span class="n">d49a933f547439d6b5b98b46af8742cc03ae83543e4d7688c2420f8b</span><span class="o">/</span><span class="n">pip</span><span class="o">-</span><span class="mf">21.3</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="o">.</span><span class="n">whl</span> <span class="p">(</span><span class="mf">1.7</span><span class="n">MB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="mi">100</span><span class="o">%</span> <span class="o">|</span><span class="err">████████████████████████████████</span><span class="o">|</span> <span class="mf">1.7</span><span class="n">MB</span> <span class="mf">26.9</span><span class="n">MB</span><span class="o">/</span><span class="n">s</span> 
</span></span><span class="line"><span class="cl"><span class="n">Installing</span> <span class="n">collected</span> <span class="n">packages</span><span class="p">:</span> <span class="n">pip</span>
</span></span><span class="line"><span class="cl">  <span class="n">Found</span> <span class="n">existing</span> <span class="n">installation</span><span class="p">:</span> <span class="n">pip</span> <span class="mf">18.1</span>
</span></span><span class="line"><span class="cl">    <span class="n">Uninstalling</span> <span class="n">pip</span><span class="o">-</span><span class="mf">18.1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">Successfully</span> <span class="n">uninstalled</span> <span class="n">pip</span><span class="o">-</span><span class="mf">18.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Successfully</span> <span class="n">installed</span> <span class="n">pip</span><span class="o">-</span><span class="mf">21.3</span><span class="o">.</span><span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="下一步python3环境好了之后可以运行项目了">下一步，python3环境好了之后，可以运行项目了
</h3><h3 id="修改jumpserver代码的配置文件">修改jumpserver代码的配置文件
</h3><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608155431919.png"
	width="1499"
	height="920"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608155431919_hu613372673386584928.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608155431919_hu1290839849215591233.png 1024w"
	loading="lazy"
	
		alt="image-20220608155431919"
	
	
		class="gallery-image" 
		data-flex-grow="162"
		data-flex-basis="391px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1.  提示，你在部署core服务，后端python服务的时候，确保全程激活虚拟环境
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2.拷贝配置文件，修改配置文件如下
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#cp config_example.yml config.yml
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#ls config.yml 
</span></span><span class="line"><span class="cl">config.yml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">3. 修改如下
</span></span><span class="line"><span class="cl">jumpserver整个架构的所有组件，相互之间的通信，都是基于一个密钥来加密的。
</span></span><span class="line"><span class="cl">基于如下命令，生成2个密钥。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">先打印这2个变量看有没有
</span></span><span class="line"><span class="cl">echo $SECRET_KEY
</span></span><span class="line"><span class="cl">echo $BOOTSTRAP_TOKEN
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"># 生成如下2个变量的随机值，待会配置文件得用
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if [ &#34;$SECRET_KEY&#34; = &#34;&#34; ]; then SECRET_KEY=`cat /dev/urandom | tr -dc A-Za-z0-9 | head -c 50`; echo &#34;SECRET_KEY=$SECRET_KEY&#34; &gt;&gt; ~/.bashrc; echo $SECRET_KEY; else echo $SECRET_KEY; fi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if [ &#34;$BOOTSTRAP_TOKEN&#34; = &#34;&#34; ]; then BOOTSTRAP_TOKEN=`cat /dev/urandom | tr -dc A-Za-z0-9 | head -c 16`; echo &#34;BOOTSTRAP_TOKEN=$BOOTSTRAP_TOKEN&#34; &gt;&gt; ~/.bashrc; echo $BOOTSTRAP_TOKEN; else echo $BOOTSTRAP_TOKEN; fi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">4. 修改jumpserver后台的配置文件【请注意，这个文件是yaml语法，空格语法很严格】
</span></span><span class="line"><span class="cl">大家，照着我这个修改即可，
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SECRET_KEY: &#34;$SECRET_KEY&#34;
</span></span><span class="line"><span class="cl">BOOTSTRAP_TOKEN: &#34;$BOOTSTRAP_TOKEN&#34;
</span></span><span class="line"><span class="cl">DEBUG: true                   # 开发建议打开 DEBUG, 生产环境应该关闭
</span></span><span class="line"><span class="cl">LOG_LEVEL: DEBUG              # 开发建议设置 DEBUG, 生产环境推荐使用 ERROR
</span></span><span class="line"><span class="cl">SESSION_EXPIRE_AT_BROWSER_CLOSE: true  # 浏览器关闭 session 过期
</span></span><span class="line"><span class="cl">DB_ENGINE: mysql	# 数据库引擎是mysql
</span></span><span class="line"><span class="cl">DB_HOST: 10.0.0.51       # 自行配置 数据库相关
</span></span><span class="line"><span class="cl">DB_PORT: 3306		# 数据库端口
</span></span><span class="line"><span class="cl">DB_USER: jumpserver		# 数据库远程连接的用户
</span></span><span class="line"><span class="cl">DB_PASSWORD: linux0224		# mysql密码
</span></span><span class="line"><span class="cl">DB_NAME: jumpserver			# mysql存储的库名
</span></span><span class="line"><span class="cl">HTTP_BIND_HOST: 0.0.0.0  	# core服务运行的地址
</span></span><span class="line"><span class="cl">HTTP_LISTEN_PORT: 8080		# core服务运行的端口
</span></span><span class="line"><span class="cl">WS_LISTEN_PORT: 8070		# 后端websocket协议的端口
</span></span><span class="line"><span class="cl">REDIS_HOST: 10.0.0.51       # 自行配置 Redis 相关
</span></span><span class="line"><span class="cl">REDIS_PORT: 6379
</span></span><span class="line"><span class="cl">REDIS_PASSWORD: linux0224	 # 自定义的redis密码
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">因此最终的配置如下
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#cat config.yml 
</span></span><span class="line"><span class="cl">SECRET_KEY: &#34;$SECRET_KEY&#34;
</span></span><span class="line"><span class="cl">BOOTSTRAP_TOKEN: &#34;$BOOTSTRAP_TOKEN&#34;
</span></span><span class="line"><span class="cl">DEBUG: true
</span></span><span class="line"><span class="cl">LOG_LEVEL: DEBUG
</span></span><span class="line"><span class="cl">SESSION_EXPIRE_AT_BROWSER_CLOSE: true
</span></span><span class="line"><span class="cl">DB_ENGINE: mysql
</span></span><span class="line"><span class="cl">DB_HOST: 10.0.0.51
</span></span><span class="line"><span class="cl">DB_PORT: 3306
</span></span><span class="line"><span class="cl">DB_USER: jumpserver
</span></span><span class="line"><span class="cl">DB_PASSWORD: linux0224
</span></span><span class="line"><span class="cl">DB_NAME: jumpserver
</span></span><span class="line"><span class="cl">HTTP_BIND_HOST: 0.0.0.0
</span></span><span class="line"><span class="cl">HTTP_LISTEN_PORT: 8080
</span></span><span class="line"><span class="cl">WS_LISTEN_PORT: 8070
</span></span><span class="line"><span class="cl">REDIS_HOST: 10.0.0.51
</span></span><span class="line"><span class="cl">REDIS_PORT: 6379
</span></span><span class="line"><span class="cl">REDIS_PASSWORD: linux0224
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="数据库迁移">数据库迁移
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">通过python3命令，生成jumpserver的核心数据库，数据表内容，会写入到mysql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">都是python开发的知识。。。运维会部署也得会。。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0/apps]#python3  ./manage.py makemigrations
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">此步骤，会写入mysql数据库的jumpserver 库中的数据表
</span></span><span class="line"><span class="cl">发现生成了97张数据表
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0/apps]#python3  ./manage.py migrate 
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="有了数据之后可以启动后端了">有了数据之后，可以启动后端了
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">进入到jumpserver源码目录中，它提供好了启动脚本。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">一键执行python的启动服务脚本，运行后端所有程序
</span></span><span class="line"><span class="cl">并且是后台运行，不会占用你的窗口，xshell关了，也不会断开。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#ls /opt/jumpserver-v2.12.0/jms 
</span></span><span class="line"><span class="cl">/opt/jumpserver-v2.12.0/jms
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#./jms start all -d 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">检查所有的组件，状态，确保有进程id号，才是对的。
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#./jms status
</span></span><span class="line"><span class="cl">gunicorn is running: 2977
</span></span><span class="line"><span class="cl">flower is running: 2992
</span></span><span class="line"><span class="cl">daphne is running: 3152
</span></span><span class="line"><span class="cl">celery_ansible is running: 3347
</span></span><span class="line"><span class="cl">celery_default is running: 3448
</span></span><span class="line"><span class="cl">beat is running: 3587
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">确保这6个进程的pid，都存在，即正确。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">以及，查看该进程的 端口，注意是端口。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(venv_py3) [root@master-61 /opt/jumpserver-v2.12.0]#netstat -tunlp
</span></span><span class="line"><span class="cl">Active Internet connections (only servers)
</span></span><span class="line"><span class="cl">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
</span></span><span class="line"><span class="cl">tcp        0      0 0.0.0.0:8070            0.0.0.0:*               LISTEN      3152/python3        
</span></span><span class="line"><span class="cl">tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      2977/python3        
</span></span><span class="line"><span class="cl">tcp        0      0 0.0.0.0:5555            0.0.0.0:*               LISTEN      2992/python3        
</span></span><span class="line"><span class="cl">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      958/sshd            
</span></span><span class="line"><span class="cl">tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1127/master         
</span></span><span class="line"><span class="cl">tcp6       0      0 :::5555                 :::*                    LISTEN      2992/python3        
</span></span><span class="line"><span class="cl">tcp6       0      0 :::22                   :::*                    LISTEN      958/sshd            
</span></span><span class="line"><span class="cl">tcp6       0      0 ::1:25                  :::*                    LISTEN      1127/master  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">直接告诉大家，后端core服务，运行的http端口是 8080
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">因此你可以试着访问试试。
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="首次访问登录修改密码">首次访问，登录，修改密码
</h3><p>首次是可以访问，它会让你修改密码，下一次，人家代码中限制，你就没法直接访问后台了，。必须通过前端lina服务器，才能访问到后台。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">admin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">首次修改密码为，lijin666
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608161309309.png"
	width="2084"
	height="1140"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608161309309_hu370606720443623312.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608161309309_hu2689708922842845915.png 1024w"
	loading="lazy"
	
		alt="image-20220608161309309"
	
	
		class="gallery-image" 
		data-flex-grow="182"
		data-flex-basis="438px"
	
></p>
<h2 id="lina前端可视化前端页面">lina前端(可视化前端页面)
</h2><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608161340735.png"
	width="2135"
	height="1492"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608161340735_hu3983689466749959726.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608161340735_hu6159959689743957920.png 1024w"
	loading="lazy"
	
		alt="image-20220608161340735"
	
	
		class="gallery-image" 
		data-flex-grow="143"
		data-flex-basis="343px"
	
></p>
<hr>
<p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608161523230.png"
	width="1369"
	height="1147"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608161523230_hu8263770113283117491.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608161523230_hu14710698923521480449.png 1024w"
	loading="lazy"
	
		alt="image-20220608161523230"
	
	
		class="gallery-image" 
		data-flex-grow="119"
		data-flex-basis="286px"
	
></p>
<h3 id="部署前端lina全流程">部署前端lina全流程
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">下载前端源代码，下载源码，解压缩。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 这里由于网络问题，我是去windows下载</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">lina</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span>
</span></span><span class="line"><span class="cl"><span class="n">wget</span> <span class="o">-</span><span class="n">O</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">lina</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">/</span><span class="n">lina</span><span class="o">/</span><span class="n">archive</span><span class="o">/</span><span class="n">refs</span><span class="o">/</span><span class="n">tags</span><span class="o">/</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">lina</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span>
</span></span><span class="line"><span class="cl"><span class="n">tar</span> <span class="o">-</span><span class="n">xf</span> <span class="n">lina</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">lina</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span> <span class="o">--</span><span class="n">strip</span><span class="o">-</span><span class="n">components</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 注意，源代码放入到指定的目录中</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 确保代码如下即可。</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#ls /opt/lina-v2.12.0</span>
</span></span><span class="line"><span class="cl"><span class="n">alias</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">js</span>  <span class="n">dump</span><span class="o">.</span><span class="n">rdb</span>        <span class="n">mock</span>               <span class="n">public</span>     <span class="n">utils</span>
</span></span><span class="line"><span class="cl"><span class="n">babel</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">js</span>  <span class="n">jest</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">js</span>  <span class="n">nginx</span><span class="o">.</span><span class="n">conf</span>         <span class="n">README</span><span class="o">.</span><span class="n">md</span>  <span class="n">vue</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">js</span>
</span></span><span class="line"><span class="cl"><span class="n">build</span>            <span class="n">jsconfig</span><span class="o">.</span><span class="n">json</span>   <span class="n">package</span><span class="o">.</span><span class="n">json</span>       <span class="n">src</span>        <span class="n">yarn</span><span class="o">.</span><span class="n">lock</span>
</span></span><span class="line"><span class="cl"><span class="n">Dockerfile</span>       <span class="n">LICENSE</span>         <span class="n">postcss</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">js</span>  <span class="n">tests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">部署</span><span class="n">nodejs</span>  <span class="err">（学到现在，你已经部署了</span> <span class="n">php编程语言</span><span class="err">，</span><span class="n">python语言</span><span class="err">，</span><span class="n">nodejs前端开发的语言</span><span class="err">）</span>
</span></span><span class="line"><span class="cl"><span class="c1"># node.js和python，php一样，是一个编程语言，专门运行*.js程序的。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 部署php后端是 2个步骤  一是下载*.php源码，安装php7解释器执行这个代码</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 部署 python后端 2个步骤  一是下载*.py，编译python3去执行代码</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 部署nodejs是因为，前端源代码是一堆*.js文件，需要用node.js解释器去运行</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 程序员大牛，必备技能ctrl +c  ctrl +v   </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span> <span class="o">&amp;&amp;</span> <span class="n">cd</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span> <span class="o">&amp;&amp;</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nodejs</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">dist</span><span class="o">/</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x64</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 这里下载，解压缩的node.js解释器，是一个二进制的命令，无须安装了，配置PATH即可使用</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tar</span> <span class="o">-</span><span class="n">xf</span> <span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x64</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span>  <span class="o">--</span><span class="n">strip</span><span class="o">-</span><span class="n">components</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tail</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">PATH</span><span class="o">=$</span><span class="n">PATH</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">python369</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 你最终，确保node.js的运行目录如下即可。</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#ls /opt/node-v10.24.1/bin</span>
</span></span><span class="line"><span class="cl"><span class="n">node</span>  <span class="n">npm</span>  <span class="n">npx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 配置PATH，确保和我一样</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#tail -2 /etc/profile</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 添加python3的PATH</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">PATH</span><span class="o">=$</span><span class="n">PATH</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">python369</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#node -v</span>
</span></span><span class="line"><span class="cl"><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#npm -v</span>
</span></span><span class="line"><span class="cl"><span class="mf">6.14</span><span class="o">.</span><span class="mi">12</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">## 确保node解释器可以用，以及npm命令可以用</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">##npm 命令又是管理 node.js项目的依赖工具，装前端依赖模块的。。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">到这里，前端的</span><span class="n">node</span><span class="o">.</span><span class="n">js开发环境</span><span class="err">，就已经部署好了</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="配置前端npm的下载加速源">配置前端npm的下载加速源
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">执行如下命令即可
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">npm config set registry https://registry.npm.taobao.org
</span></span><span class="line"><span class="cl">npm config get registry
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="理解npm和node的关系对比pip和python的关系">理解npm和node的关系（对比pip和python的关系）
</h3><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608163201340.png"
	width="2456"
	height="1503"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608163201340_hu9636843245734970663.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608163201340_hu4325052192400748402.png 1024w"
	loading="lazy"
	
		alt="image-20220608163201340"
	
	
		class="gallery-image" 
		data-flex-grow="163"
		data-flex-basis="392px"
	
></p>
<h3 id="安装前端源代码的依赖">安装前端源代码的依赖
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># 1.配置加速源
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#cd /opt/lina-v2.12.0/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">配置淘宝的下载加速源
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#npm config set registry https://registry.npm.taobao.org
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#npm config get registry
</span></span><span class="line"><span class="cl">https://registry.npm.taobao.org/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 2.进入源代码目录，执行命令，安装即可、
</span></span><span class="line"><span class="cl">先安装yarn工具，为了安装前端vue的依赖，跟着操作就行，都是前端开发的知识。
</span></span><span class="line"><span class="cl">公司里会有前端工程师，配合你，给你文档，你跟着操作就行。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#npm install -g yarn
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 3.通过如下命令，安装前端的依赖
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#yarn install
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 4.你只需要确保，能理解这些步骤，是在部署前端代码，下载前端的项目依赖，确保命令正确执行就OK
</span></span><span class="line"><span class="cl">只要别跟着笔记操作，一个命令8个报错就行。。。。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 装前端依赖，装十次，得报错8次，没办法，和前端工程协同工作，报错直接发给他，让他看。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 多玩几次，就熟练了，
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 一般的错误，你作为一个高级运维，你还是得自己先看一看报错，试着解决，
</span></span><span class="line"><span class="cl"># 疑难杂症，得让前端配合你。。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 生产环境下的部署，需要有前端、后端的接口、参数、调试配合，如果没有自动化的话，一天时间，能跑起来。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">剩下的复杂的接口，其他程序，数据能调通，慢慢来了。。
</span></span></code></pre></td></tr></table>
</div>
</div><p>最终，确保如下安装结果，才是对的。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">lina</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">lina</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="p">]</span><span class="c1">#yarn install</span>
</span></span><span class="line"><span class="cl"><span class="n">yarn</span> <span class="n">install</span> <span class="n">v1</span><span class="o">.</span><span class="mf">22.19</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">]</span> <span class="n">Validating</span> <span class="n">package</span><span class="o">.</span><span class="n">json</span><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">]</span> <span class="n">Resolving</span> <span class="n">packages</span><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">]</span> <span class="n">Fetching</span> <span class="n">packages</span><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">############################################-----------------------------------------------------------------[############################################-----------------------------------------------------------------[############################################-----------------------------------------------------------------[#############################################---------------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="n">warning</span> <span class="n">url</span><span class="o">-</span><span class="n">loader</span><span class="err">@</span><span class="mf">1.1</span><span class="o">.</span><span class="mi">2</span><span class="p">:</span> <span class="n">Invalid</span> <span class="n">bin</span> <span class="n">field</span> <span class="k">for</span> <span class="s2">&#34;url-loader&#34;</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">#########################################################################-----------------------] 1284/1681</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">]</span> <span class="n">Linking</span> <span class="n">dependencies</span><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">warning</span> <span class="s2">&#34; &gt; less-loader@5.0.0&#34;</span> <span class="n">has</span> <span class="n">unmet</span> <span class="n">peer</span> <span class="n">dependency</span> <span class="s2">&#34;webpack@^2.0.0 || ^3.0.0 || ^4.0.0&#34;</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">warning</span> <span class="s2">&#34; &gt; html-webpack-plugin@3.2.0&#34;</span> <span class="n">has</span> <span class="n">unmet</span> <span class="n">peer</span> <span class="n">dependency</span> <span class="s2">&#34;webpack@^1.0.0 || ^2.0.0 || ^3.0.0 || ^4.0.0&#34;</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">warning</span> <span class="s2">&#34; &gt; compression-webpack-plugin@6.1.1&#34;</span> <span class="n">has</span> <span class="n">unmet</span> <span class="n">peer</span> <span class="n">dependency</span> <span class="s2">&#34;webpack@^4.0.0 || ^5.0.0&#34;</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">warning</span> <span class="s2">&#34; &gt; sass-loader@7.3.1&#34;</span> <span class="n">has</span> <span class="n">unmet</span> <span class="n">peer</span> <span class="n">dependency</span> <span class="s2">&#34;webpack@^3.0.0 || ^4.0.0&#34;</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">warning</span> <span class="s2">&#34; &gt; script-ext-html-webpack-plugin@2.1.3&#34;</span> <span class="n">has</span> <span class="n">unmet</span> <span class="n">peer</span> <span class="n">dependency</span> <span class="s2">&#34;webpack@^1.0.0 || ^2.0.0 || ^3.0.0 || ^4.0.0&#34;</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">5</span><span class="o">/</span><span class="mi">5</span><span class="p">]</span> <span class="n">Building</span> <span class="n">fresh</span> <span class="n">packages</span><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">success</span> <span class="n">Saved</span> <span class="n">lockfile</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">Done</span> <span class="ow">in</span> <span class="mf">259.36</span><span class="n">s</span><span class="o">.</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="修改前端的js文件设置一些运行参数">修改前端的js文件，设置一些运行参数
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">lina</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="p">]</span><span class="c1">#cat .env.development </span>
</span></span><span class="line"><span class="cl"><span class="c1"># 全局环境变量 请勿随意改动</span>
</span></span><span class="line"><span class="cl"><span class="n">ENV</span> <span class="o">=</span> <span class="s1">&#39;development&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># base api</span>
</span></span><span class="line"><span class="cl"><span class="n">VUE_APP_BASE_API</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">VUE_APP_PUBLIC_PATH</span> <span class="o">=</span> <span class="s1">&#39;/ui/&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># vue-cli uses the VUE_CLI_BABEL_TRANSPILE_MODULES environment variable,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># to control whether the babel-plugin-dynamic-import-node plugin is enabled.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># It only does one thing by converting all import() to require().</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This configuration can significantly increase the speed of hot updates,</span>
</span></span><span class="line"><span class="cl"><span class="c1"># when you have a large number of pages.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Detail:  https://github.com/vuejs/vue-cli/blob/dev/packages/@vue/babel-preset-app/index.js</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">VUE_CLI_BABEL_TRANSPILE_MODULES</span> <span class="o">=</span> <span class="bp">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># External auth</span>
</span></span><span class="line"><span class="cl"><span class="n">VUE_APP_LOGIN_PATH</span> <span class="o">=</span> <span class="s1">&#39;/core/auth/login/&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">VUE_APP_LOGOUT_PATH</span> <span class="o">=</span> <span class="s1">&#39;/core/auth/logout/&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Dev server for core proxy</span>
</span></span><span class="line"><span class="cl"><span class="n">VUE_APP_CORE_HOST</span> <span class="o">=</span> <span class="s1">&#39;http://localhost:8080&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">VUE_APP_ENV</span> <span class="o">=</span> <span class="s1">&#39;development&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 我们这里是测试，前端的lina项目和后端的core项目运行在同一台机器，因此 这里用</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 前端后端在一起的用法。</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 还记得，我们刚才去访问 core的堡垒机登录页面，确认后端端口是8080</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">所这里啥也没改。</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="运行lina前端项目">运行lina前端项目
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">执行如下命令，让lina在后台运行即可。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#nohup yarn serve &amp;  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]## 确保如下端口存在，前端的lina进程就已经运行了，前端端口是 9528
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#netstat -tunlp|grep 9528
</span></span><span class="line"><span class="cl">tcp        0      0 0.0.0.0:9528            0.0.0.0:*               LISTEN      5385/node   
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608164529398.png"
	width="2806"
	height="1085"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608164529398_hu1450308171538957907.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608164529398_hu2742877428930717806.png 1024w"
	loading="lazy"
	
		alt="image-20220608164529398"
	
	
		class="gallery-image" 
		data-flex-grow="258"
		data-flex-basis="620px"
	
></p>
<h3 id="测试访问前端">测试访问前端
</h3><p>至此，你已经可以基于如下的通信请求，正确访问堡垒机了。</p>
<p>但是，还缺少</p>
<ul>
<li>nginx做端口代理</li>
<li>其他基础组件。</li>
</ul>
<p>测试访问，能确保正确看到堡垒机后台，就OK</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">访问的地址入口是前端
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">http://10.0.0.61:9528/
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608164926732.png"
	width="2546"
	height="1847"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608164926732_hu7421109810261871395.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608164926732_hu5409642154693361372.png 1024w"
	loading="lazy"
	
		alt="image-20220608164926732"
	
	
		class="gallery-image" 
		data-flex-grow="137"
		data-flex-basis="330px"
	
></p>
<h3 id="前端lina后端core的架构图">前端lina、后端core的架构图
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">目前完成的任务
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">1. db-51的 mysql，redis组件
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2. master-61  core后台组件    lina前端组件
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608171540235.png"
	width="2435"
	height="1887"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608171540235_hu12521218036924589593.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608171540235_hu2444653498864711547.png 1024w"
	loading="lazy"
	
		alt="image-20220608171540235"
	
	
		class="gallery-image" 
		data-flex-grow="129"
		data-flex-basis="309px"
	
></p>
<h2 id="luna前端网页版命令行">luna前端（网页版命令行）
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">lina项目，是堡垒机的前端项目，咱们目前是运行了一个前端进程  10.0.0.61:9528 对的吧。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">在生产环境下的部署，会有前端工程师配合你，将所有的前端的代码，编译 执行前端的 build命令，生成 纯静态文件。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">得前端代码中，填写后端的接口地址（负载均衡的地址）
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">这个得你清晰部署流程。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">还有一个luna组件，提供网页版命令行的，这个功能也是是基于 vue前端开发的页面 +  和后端进行数据交互，提供的网页版命令行。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">web开发的知识。。大家不用过多琢磨。。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">学会如何部署即可。。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">1. 部署node环境，因为需要运行 luna的前端代码。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#node -v
</span></span><span class="line"><span class="cl">v10.24.1
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lina-v2.12.0]#npm -v
</span></span><span class="line"><span class="cl">6.14.12
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2.下载luna的前端源代码
</span></span><span class="line"><span class="cl">mkdir -p  /opt/luna-v2.12.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">wget -O /opt/luna-v2.12.0.tar.gz https://github.com/jumpserver/luna/archive/refs/tags/v2.12.0.tar.gz
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tar -xf luna-v2.12.0.tar.gz -C /opt/luna-v2.12.0 --strip-components 1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">最后确保如下代码一样即可。
</span></span><span class="line"><span class="cl">[root@master-61 /opt]#ls /opt/luna-v2.12.0
</span></span><span class="line"><span class="cl">angular.json  Dockerfile  e2e            LICENSE  nginx.conf    package-lock.json   proxy.conf.json  src            tslint.json
</span></span><span class="line"><span class="cl">deploy        docs        karma.conf.js  mock.py  package.json  protractor.conf.js  README.md        tsconfig.json  utils
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">3.安装luna项目的前端依赖，安装依赖的时候，发现缺少如下gcc工具，跟着操作，安装即可。踩坑之后的文档。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">yum -y install gcc gcc-c++
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">4. 安装前端的依赖，很棘手，很容易出现问题。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">执行如下2条命令。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">命令一，安装依赖，直接执行这个命令即可，会自动寻找目录下的 package.json文件，安装前端依赖信息
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@master-61 /opt/luna-v2.12.0]#pwd
</span></span><span class="line"><span class="cl">/opt/luna-v2.12.0
</span></span><span class="line"><span class="cl">[root@master-61 /opt/luna-v2.12.0]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt/luna-v2.12.0]#npm install 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">老师的机器安装了如下1477个依赖包。
</span></span><span class="line"><span class="cl">added 1477 packages from 1909 contributors in 244.312s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">11 packages are looking for funding
</span></span><span class="line"><span class="cl">  run `npm fund` for details
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">命令二：
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 必须安装对应版本的 node-sass依赖，否则又是一堆报错。
</span></span><span class="line"><span class="cl"># 这个命令是单独的，安装一个组件，限定了版本，这是我踩坑的解决办法，你跟着操作就行。
</span></span><span class="line"><span class="cl"># 你根据这个教程，部署的是v2.12.0 luna源代码，因此这个前端项目，依赖的模块，有指定的版本。
</span></span><span class="line"><span class="cl"># 如果是其他的luna源码版本你或许不需要装这个操作。。理解即可。。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SASS_BINARY_SITE=https://npm.taobao.org/mirrors/node-sass/ 
</span></span><span class="line"><span class="cl">npm install node-sass@4.13.0
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果想加速下载，可以设置linux的全局http_proxy代理。走你的梯子即可。</p>
<p>http,https的数据请求。</p>
<p>搞个梯子，设置全局http代理，</p>
<p>【机器请求 &gt; 梯子】 &gt; 发给目标机器</p>
<p>称之为正向代理，还是反向代理？</p>
<p>正向代理。</p>
<h3 id="修改luna-的配置文件">修改luna 的配置文件
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">由于luna和 core服务部署在一台机器，因此这里的地址，不用用localhost
</span></span><span class="line"><span class="cl">如果luna和core服务，分开在不同得机器，你得填写 core机器的ip
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">因此这里，啥也不写即可
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@master-61 /opt/luna-v2.12.0]#cat proxy.conf.json 
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  &#34;/koko&#34;: {
</span></span><span class="line"><span class="cl">    &#34;target&#34;: &#34;http://localhost:5000&#34;,
</span></span><span class="line"><span class="cl">    &#34;secure&#34;: false,
</span></span><span class="line"><span class="cl">    &#34;ws&#34;: true
</span></span><span class="line"><span class="cl">  },
</span></span><span class="line"><span class="cl">  &#34;/media/&#34;: {
</span></span><span class="line"><span class="cl">    &#34;target&#34;: &#34;http://localhost:8080&#34;,
</span></span><span class="line"><span class="cl">    &#34;secure&#34;: false,
</span></span><span class="line"><span class="cl">    &#34;changeOrigin&#34;: true
</span></span><span class="line"><span class="cl">  },
</span></span><span class="line"><span class="cl">  &#34;/api/&#34;: {
</span></span><span class="line"><span class="cl">    &#34;target&#34;: &#34;http://localhost:8080&#34;,
</span></span><span class="line"><span class="cl">    &#34;secure&#34;: false,
</span></span><span class="line"><span class="cl">    &#34;changeOrigin&#34;: true
</span></span><span class="line"><span class="cl">  },
</span></span><span class="line"><span class="cl">  &#34;/core&#34;: {
</span></span><span class="line"><span class="cl">    &#34;target&#34;: &#34;http://localhost:8080&#34;,
</span></span><span class="line"><span class="cl">    &#34;secure&#34;: false,
</span></span><span class="line"><span class="cl">    &#34;changeOrigin&#34;: true
</span></span><span class="line"><span class="cl">  },
</span></span><span class="line"><span class="cl">  &#34;/static&#34;: {
</span></span><span class="line"><span class="cl">    &#34;target&#34;: &#34;http://localhost:8080&#34;,
</span></span><span class="line"><span class="cl">    &#34;secure&#34;: false,
</span></span><span class="line"><span class="cl">    &#34;changeOrigin&#34;: true
</span></span><span class="line"><span class="cl">  },
</span></span><span class="line"><span class="cl">  &#34;/lion&#34;: {
</span></span><span class="line"><span class="cl">    &#34;target&#34;: &#34;http://localhost:9529&#34;,
</span></span><span class="line"><span class="cl">    &#34;secure&#34;: false,
</span></span><span class="line"><span class="cl">    &#34;pathRewrite&#34;: {
</span></span><span class="line"><span class="cl">      &#34;^/lion/monitor&#34;: &#34;/monitor&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    &#34;ws&#34;: true,
</span></span><span class="line"><span class="cl">    &#34;changeOrigin&#34;: true
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">[root@master-61 /opt/luna-v2.12.0]#
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="启动luna">启动luna
</h3><p>需要安装ng命令</p>
<p>你要运行luna这个项目，需要安装ng命令，为了执行，<code>ng server 运行luna进程</code> ，</p>
<p>这是前端的命令工具。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="c1"># 安装ng命令，用于启动前端服务器，注意，必须是这个版本（再次吐槽，官网文档，就不能用心点写吗？一堆烂坑）</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 安装这个ng命令，使用这条命令，添加--unsafe-perm参数，提权，让node的权限大一点</span>
</span></span><span class="line"><span class="cl"><span class="n">npm</span> <span class="n">install</span> <span class="o">-</span><span class="n">g</span> <span class="err">@</span><span class="n">angular</span><span class="o">/</span><span class="n">cli</span><span class="err">@</span><span class="mf">1.3</span><span class="o">.</span><span class="mi">2</span>  <span class="o">--</span><span class="n">unsafe</span><span class="o">-</span><span class="n">perm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 确保ng命令能装好,执行如下命令即可。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">luna</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="p">]</span><span class="c1">#ng --version</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="n">_</span>                      <span class="n">_</span>                 <span class="n">____</span> <span class="n">_</span>     <span class="n">___</span>
</span></span><span class="line"><span class="cl">    <span class="o">/</span> \   <span class="n">_</span> <span class="n">__</span>   <span class="n">__</span> <span class="n">_</span> <span class="n">_</span>   <span class="n">_</span><span class="o">|</span> <span class="o">|</span> <span class="n">__</span> <span class="n">_</span> <span class="n">_</span> <span class="n">__</span>     <span class="o">/</span> <span class="n">___</span><span class="o">|</span> <span class="o">|</span>   <span class="o">|</span><span class="n">_</span> <span class="n">_</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">   <span class="o">/</span> <span class="err">△</span> \ <span class="o">|</span> <span class="s1">&#39;_ \ / _` | | | | |/ _` | &#39;</span><span class="n">__</span><span class="o">|</span>   <span class="o">|</span> <span class="o">|</span>   <span class="o">|</span> <span class="o">|</span>    <span class="o">|</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl">  <span class="o">/</span> <span class="n">___</span> \<span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="p">(</span><span class="n">_</span><span class="o">|</span> <span class="o">|</span> <span class="o">|</span><span class="n">_</span><span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="p">(</span><span class="n">_</span><span class="o">|</span> <span class="o">|</span> <span class="o">|</span>      <span class="o">|</span> <span class="o">|</span><span class="n">___</span><span class="o">|</span> <span class="o">|</span><span class="n">___</span> <span class="o">|</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl"> <span class="o">/</span><span class="n">_</span><span class="o">/</span>   \<span class="n">_</span>\<span class="n">_</span><span class="o">|</span> <span class="o">|</span><span class="n">_</span><span class="o">|</span>\<span class="n">__</span><span class="p">,</span> <span class="o">|</span>\<span class="n">__</span><span class="p">,</span><span class="n">_</span><span class="o">|</span><span class="n">_</span><span class="o">|</span>\<span class="n">__</span><span class="p">,</span><span class="n">_</span><span class="o">|</span><span class="n">_</span><span class="o">|</span>       \<span class="n">____</span><span class="o">|</span><span class="n">_____</span><span class="o">|</span><span class="n">___</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span><span class="n">___</span><span class="o">/</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Angular</span> <span class="n">CLI</span><span class="p">:</span> <span class="mf">7.3</span><span class="o">.</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="ne">Node</span><span class="p">:</span> <span class="mf">10.24</span><span class="o">.</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="ne">OS</span><span class="p">:</span> <span class="n">linux</span> <span class="n">x64</span>
</span></span><span class="line"><span class="cl"><span class="n">Angular</span><span class="p">:</span> <span class="mf">7.2</span><span class="o">.</span><span class="mi">15</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span> <span class="n">animations</span><span class="p">,</span> <span class="n">common</span><span class="p">,</span> <span class="n">compiler</span><span class="p">,</span> <span class="n">compiler</span><span class="o">-</span><span class="n">cli</span><span class="p">,</span> <span class="n">core</span><span class="p">,</span> <span class="n">forms</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span> <span class="n">http</span><span class="p">,</span> <span class="n">language</span><span class="o">-</span><span class="n">service</span><span class="p">,</span> <span class="n">platform</span><span class="o">-</span><span class="n">browser</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span> <span class="n">platform</span><span class="o">-</span><span class="n">browser</span><span class="o">-</span><span class="n">dynamic</span><span class="p">,</span> <span class="n">router</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Package</span>                           <span class="n">Version</span>
</span></span><span class="line"><span class="cl"><span class="o">-----------------------------------------------------------</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">angular</span><span class="o">-</span><span class="n">devkit</span><span class="o">/</span><span class="n">architect</span>         <span class="mf">0.13</span><span class="o">.</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">angular</span><span class="o">-</span><span class="n">devkit</span><span class="o">/</span><span class="n">build</span><span class="o">-</span><span class="n">angular</span>     <span class="mf">0.13</span><span class="o">.</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">angular</span><span class="o">-</span><span class="n">devkit</span><span class="o">/</span><span class="n">build</span><span class="o">-</span><span class="n">optimizer</span>   <span class="mf">0.13</span><span class="o">.</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">angular</span><span class="o">-</span><span class="n">devkit</span><span class="o">/</span><span class="n">build</span><span class="o">-</span><span class="n">webpack</span>     <span class="mf">0.13</span><span class="o">.</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">angular</span><span class="o">-</span><span class="n">devkit</span><span class="o">/</span><span class="n">core</span>              <span class="mf">7.3</span><span class="o">.</span><span class="mi">9</span> <span class="p">(</span><span class="n">cli</span><span class="o">-</span><span class="n">only</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">angular</span><span class="o">-</span><span class="n">devkit</span><span class="o">/</span><span class="n">schematics</span>        <span class="mf">7.3</span><span class="o">.</span><span class="mi">9</span> <span class="p">(</span><span class="n">cli</span><span class="o">-</span><span class="n">only</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">angular</span><span class="o">/</span><span class="n">cdk</span>                      <span class="mf">7.3</span><span class="o">.</span><span class="mi">7</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">angular</span><span class="o">/</span><span class="n">cli</span>                      <span class="mf">7.3</span><span class="o">.</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">angular</span><span class="o">/</span><span class="n">flex</span><span class="o">-</span><span class="n">layout</span>              <span class="mf">7.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">beta</span><span class="o">.</span><span class="mi">24</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">angular</span><span class="o">/</span><span class="n">material</span>                 <span class="mf">7.3</span><span class="o">.</span><span class="mi">7</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">ngtools</span><span class="o">/</span><span class="n">webpack</span>                  <span class="mf">7.3</span><span class="o">.</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">schematics</span><span class="o">/</span><span class="n">angular</span>               <span class="mf">7.3</span><span class="o">.</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">schematics</span><span class="o">/</span><span class="n">update</span>                <span class="mf">0.13</span><span class="o">.</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl"><span class="n">rxjs</span>                              <span class="mf">6.3</span><span class="o">.</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">typescript</span>                        <span class="mf">3.2</span><span class="o">.</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="n">webpack</span>                           <span class="mf">4.29</span><span class="o">.</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 后台运行命令如下，必须运行在0.0.0.0地址上，否则不通。</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 必须执行这个命令。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 当前是没有luna的端口的</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">luna</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="p">]</span><span class="c1">#netstat -tunlp|grep 4200</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行命令，运行luna进程</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">luna</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="p">]</span><span class="c1">#nohup ng serve --proxy-config proxy.conf.json --host 0.0.0.0 &amp; </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 检查端口</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">luna</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="p">]</span><span class="c1">#netstat -tunlp|grep 4200</span>
</span></span><span class="line"><span class="cl"><span class="n">tcp</span>        <span class="mi">0</span>      <span class="mi">0</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">4200</span>            <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="o">*</span>               <span class="n">LISTEN</span>      <span class="mi">7244</span><span class="o">/</span><span class="err">@</span><span class="n">angular</span><span class="o">/</span><span class="n">cli</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 至此，luna就OK了，可以访问网页版linux命令行了。</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608174349427.png"
	width="2323"
	height="1601"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608174349427_hu12377703052254416722.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608174349427_hu948140881728510866.png 1024w"
	loading="lazy"
	
		alt="image-20220608174349427"
	
	
		class="gallery-image" 
		data-flex-grow="145"
		data-flex-basis="348px"
	
></p>
<h3 id="测试访问luna">测试访问luna
</h3><p>由于这个luna版本，有点问题，v2.12.0，总是需要前端工程师配合，才能精确的调通。</p>
<p>这里的部署，有点bug，需要指定luna的端口才可以访问到 网页版命令行。</p>
<p>以及luna需要去连接koko服务，才能实现远程网页，执行linux命令。</p>
<p>你先确保可以看到luna的页面。</p>
<p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608174703685.png"
	width="2360"
	height="1608"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608174703685_hu8348572496758974655.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608174703685_hu14099854627742574386.png 1024w"
	loading="lazy"
	
		alt="image-20220608174703685"
	
	
		class="gallery-image" 
		data-flex-grow="146"
		data-flex-basis="352px"
	
></p>
<h2 id="koko后端命令行版堡垒机">koko后端（命令行版堡垒机）
</h2><p>早期的命令行堡垒机，是基于coco服务，是飞致云公司，基于python开发的工具。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">部署python的环境，运行coco代码。
</span></span></code></pre></td></tr></table>
</div>
</div><p>后来代码升级，基于golang重构了，换为了koko。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">需要提供golang的开发环境，才能运行koko
</span></span></code></pre></td></tr></table>
</div>
</div><p>Koko 是 Go 版本的 coco，重构了 coco 的 SSH/SFTP 服务和 Web Terminal 服务。</p>
<p>Koko组件用于基于ssh的跳板机登录，统一管理。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">jumpserver是一个 跳板机（koko）的升级版，添加了很多4A功能，完成了整个的堡垒机产品。
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="部署koko">部署koko
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">下载</span><span class="n">koko代码</span><span class="err">，由于是基于</span><span class="n">golang开发</span><span class="err">，可以直接打包二进制，你无须安装了，下载即用。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mkdir</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">koko</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="n">opt</span> <span class="p">;</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">/</span><span class="n">koko</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">/</span><span class="n">koko</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tar</span> <span class="o">-</span><span class="n">xf</span> <span class="n">koko</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>  <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">koko</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span> <span class="o">--</span><span class="n">strip</span><span class="o">-</span><span class="n">components</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">确保如下目录存在即可</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#ls /opt/koko-v2.12.0</span>
</span></span><span class="line"><span class="cl"><span class="n">config_example</span><span class="o">.</span><span class="n">yml</span>  <span class="n">init</span><span class="o">-</span><span class="n">kubectl</span><span class="o">.</span><span class="n">sh</span>  <span class="n">koko</span>  <span class="n">kubectl</span>  <span class="n">locale</span>  <span class="k">static</span>  <span class="n">templates</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">3.</span><span class="err">配置</span><span class="n">golang的环境</span><span class="err">，也是下载即可，然后配置环境变量就可以用了</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">直接下载二进制版本</span>
</span></span><span class="line"><span class="cl"><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">golang</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">cn</span><span class="o">/</span><span class="n">dl</span><span class="o">/</span><span class="n">go1</span><span class="o">.</span><span class="mf">15.</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tar</span> <span class="o">-</span><span class="n">xf</span> <span class="n">go1</span><span class="o">.</span><span class="mf">15.</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">添加</span><span class="n">path</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#tail -2 /etc/profile</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 添加python3的PATH</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">PATH</span><span class="o">=$</span><span class="n">PATH</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">python369</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">node</span><span class="o">-</span><span class="n">v10</span><span class="o">.</span><span class="mf">24.1</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">bin</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">确认版本</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#source /etc/profile</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">bin</span><span class="p">]</span><span class="c1">#go version</span>
</span></span><span class="line"><span class="cl"><span class="n">go</span> <span class="n">version</span> <span class="n">go1</span><span class="o">.</span><span class="mi">15</span> <span class="n">linux</span><span class="o">/</span><span class="n">amd64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">至此</span><span class="n">golang开发环境</span><span class="err">，</span><span class="n">go编译器已经装好</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="启动koko">启动koko
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1.先修改配置文件
</span></span><span class="line"><span class="cl">[root@master-61 /opt/koko-v2.12.0]#cp config_example.yml config.yml
</span></span><span class="line"><span class="cl">[root@master-61 /opt/koko-v2.12.0]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt/koko-v2.12.0]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt/koko-v2.12.0]#ls
</span></span><span class="line"><span class="cl">config_example.yml  config.yml  init-kubectl.sh  koko  kubectl  locale  static  templates
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2. 修改如下即可
</span></span><span class="line"><span class="cl">CORE_HOST: http://127.0.0.1:8080   # Core 的地址
</span></span><span class="line"><span class="cl"># 第一次运行的时候，koko会用这个值，注册当前机器的信息到jumpserver中，证明这个机器是当做了跳板机，安全验证
</span></span><span class="line"><span class="cl"># 第二次运行，这个参数就给删除即可，否则会反复注册，如果说你运行koko出了问题，找老师，你估计解决不了。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">BOOTSTRAP_TOKEN: &#34;$BOOTSTRAP_TOKEN&#34; 
</span></span><span class="line"><span class="cl">BIND_HOST: 0.0.0.0         # koko服务绑定运行在0.0.0.0上，表示可以基于10.0.0.61访问
</span></span><span class="line"><span class="cl"># 表示你可以基于ssh 协议，连接koko， 用法是  ssh root@10.0.0.61  -p 2222
</span></span><span class="line"><span class="cl"># 连接22端口是 sshd进程，  连接2222是koko进程
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SSHD_PORT: 2222            # 使用 0.0.0.0:2222,
</span></span><span class="line"><span class="cl">HTTPD_PORT: 5000           # 使用 0.0.0.0:5000
</span></span><span class="line"><span class="cl">LOG_LEVEL: DEBUG           # 开发建议设置 DEBUG, 生产环境推荐使用 ERROR
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">3.具体配置如下，和我一样即可
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@master-61 /opt/koko-v2.12.0]#cat config.yml 
</span></span><span class="line"><span class="cl">CORE_HOST: http://127.0.0.1:8080
</span></span><span class="line"><span class="cl">BOOTSTRAP_TOKEN: &#34;$BOOTSTRAP_TOKEN&#34;
</span></span><span class="line"><span class="cl">BIND_HOST: 0.0.0.0
</span></span><span class="line"><span class="cl">SSHD_PORT: 2222
</span></span><span class="line"><span class="cl">HTTPD_PORT: 5000
</span></span><span class="line"><span class="cl">LOG_LEVEL: DEBUG
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">4.运行koko服务，首次会注册到堡垒机中，以及确保2222，和5000端口都运行了，koko才是正常运行。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@master-61 /opt/koko-v2.12.0]#ls
</span></span><span class="line"><span class="cl">config_example.yml  config.yml  init-kubectl.sh  koko  kubectl  locale  static  templates
</span></span><span class="line"><span class="cl">[root@master-61 /opt/koko-v2.12.0]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt/koko-v2.12.0]#
</span></span><span class="line"><span class="cl">[root@master-61 /opt/koko-v2.12.0]#./koko  -f config.yml  -d  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">5.验证koko的运行
</span></span><span class="line"><span class="cl">[root@master-61 /opt/koko-v2.12.0]#netstat -tunlp|grep -E &#39;(5000|2222)&#39;
</span></span><span class="line"><span class="cl">tcp6       0      0 :::5000                 :::*                    LISTEN      7613/./koko         
</span></span><span class="line"><span class="cl">tcp6       0      0 :::2222                 :::*                    LISTEN      7613/./koko    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">6.至此，koko已经运行成功了
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="此时你可以试试跳板机的实际用法了1访问luna的网页命令行">此时你可以试试，跳板机的实际用法了，1.访问luna的网页命令行
</h3><p>由于还没在堡垒机中，添加你的服务器资产数据，所以说看不到服务器列表，下节课，添加资产列表就可以管理你的机器了。</p>
<p>为了验证luna和koko结合，点击文件管理功能即可。</p>
<p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608182431412.png"
	width="1706"
	height="1075"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608182431412_hu5629776978497218757.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608182431412_hu729446022265279592.png 1024w"
	loading="lazy"
	
		alt="image-20220608182431412"
	
	
		class="gallery-image" 
		data-flex-grow="158"
		data-flex-basis="380px"
	
></p>
<h3 id="以及试试基于ssh协议连接koko">以及试试，基于ssh协议连接koko
</h3><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608182530424.png"
	width="2089"
	height="1500"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608182530424_hu12270171118757965311.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608182530424_hu8515312365125048663.png 1024w"
	loading="lazy"
	
		alt="image-20220608182530424"
	
	
		class="gallery-image" 
		data-flex-grow="139"
		data-flex-basis="334px"
	
></p>
<p>确保如下操作，正常即可，说明你的koko，跳板机以及可以使用，使用的是jumpserver的用户信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">账户 admin  密码lijin666
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ssh admin@10.0.0.61 -p 2222
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608182714172.png"
	width="1510"
	height="606"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608182714172_hu6628271394354290447.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608182714172_hu18104465745383948446.png 1024w"
	loading="lazy"
	
		alt="image-20220608182714172"
	
	
		class="gallery-image" 
		data-flex-grow="249"
		data-flex-basis="598px"
	
></p>
<p>说明你的koko，命令行，跳板机已经可以用了。</p>
<h2 id="部署lion提供vnc远程桌面功能">部署lion（提供vnc远程桌面功能）
</h2><blockquote>
<p>体验下，阿里云服务器的两种登录方式。</p>
<p>无法基于ssh连接的话，基于vnc连接去解决机器的故障。</p>
</blockquote>
<p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608183017555.png"
	width="2347"
	height="1275"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608183017555_hu3811491100425280837.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608183017555_hu9050949036851196470.png 1024w"
	loading="lazy"
	
		alt="image-20220608183017555"
	
	
		class="gallery-image" 
		data-flex-grow="184"
		data-flex-basis="441px"
	
></p>
<p>下一步，部署jumpserver也提供给你的lion服务</p>
<h3 id="先装一个工具叫做-guacamole远程桌面依赖的一个前端框架">先装一个工具叫做 guacamole，远程桌面依赖的一个前端框架
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">mkdir</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">guacamole</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">guacamole</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span>
</span></span><span class="line"><span class="cl"><span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="o">.</span><span class="n">jumpserver</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">guacamole</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mf">1.3</span><span class="o">.</span><span class="mf">0.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl"><span class="n">tar</span> <span class="o">-</span><span class="n">xzf</span> <span class="n">guacamole</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mf">1.3</span><span class="o">.</span><span class="mf">0.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="n">guacamole</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mf">1.3</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">注意，需要安装</span><span class="n">centos的依赖环境</span><span class="err">，才可以使用这个</span><span class="n">VNC远程桌面协议</span><span class="err">。</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 踩坑了</span>
</span></span><span class="line"><span class="cl"><span class="n">yum</span> <span class="o">-</span><span class="n">y</span> <span class="n">install</span> <span class="n">cairo</span><span class="o">-</span><span class="n">devel</span> <span class="n">libjpeg</span><span class="o">-</span><span class="n">devel</span> <span class="n">libpng</span><span class="o">-</span><span class="n">devel</span> <span class="n">uuid</span><span class="o">-</span><span class="n">devel</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 粘贴如下代码即可</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">./</span><span class="n">configure</span> <span class="o">--</span><span class="n">with</span><span class="o">-</span><span class="n">init</span><span class="o">-</span><span class="n">dir</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span>
</span></span><span class="line"><span class="cl"><span class="n">make</span> <span class="o">&amp;&amp;</span> <span class="n">make</span> <span class="n">install</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 让你的linux，更新底层的驱动，加载远程桌面 guacamole协议</span>
</span></span><span class="line"><span class="cl"><span class="n">ldconfig</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="安装lion程序">安装lion程序
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">/</span><span class="n">opt</span>
</span></span><span class="line"><span class="cl"><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jumpserver</span><span class="o">/</span><span class="n">lion</span><span class="o">-</span><span class="n">release</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">/</span><span class="n">lion</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tar</span> <span class="o">-</span><span class="n">xf</span> <span class="n">lion</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="n">lion</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">最终看到如下数据即可</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#tar -xf lion-v2.12.0-linux-amd64_\(1\).tar.gz </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="p">]</span><span class="c1">#cd lion-v2.12.0-linux-amd64/</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">lion</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">lion</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="p">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">lion</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="p">]</span><span class="c1">#ls</span>
</span></span><span class="line"><span class="cl"><span class="n">config_example</span><span class="o">.</span><span class="n">yml</span>  <span class="n">lion</span>  <span class="n">ui</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">拷贝配置文件</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">master</span><span class="o">-</span><span class="mi">61</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">lion</span><span class="o">-</span><span class="n">v2</span><span class="o">.</span><span class="mf">12.0</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">amd64</span><span class="p">]</span><span class="c1">#cp config_example.yml config.yml</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">修改配置文件，参考如下写法</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 项目名称, 会用来向Jumpserver注册, 识别而已, 不能重复</span>
</span></span><span class="line"><span class="cl"><span class="c1"># NAME: </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Jumpserver项目的url, api请求注册会使用</span>
</span></span><span class="line"><span class="cl"><span class="n">CORE_HOST</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">8080</span>   <span class="c1"># Core 的地址</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Bootstrap Token, 预共享秘钥, 用来注册使用的service account和terminal</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 请和jumpserver 配置文件中保持一致，注册完成后可以删除</span>
</span></span><span class="line"><span class="cl"><span class="n">BOOTSTRAP_TOKEN</span><span class="p">:</span> <span class="s2">&#34;$BOOTSTRAP_TOKEN&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 启动时绑定的ip, 默认 0.0.0.0</span>
</span></span><span class="line"><span class="cl"><span class="n">BIND_HOST</span><span class="p">:</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 监听的HTTP/WS端口号，默认8081</span>
</span></span><span class="line"><span class="cl"><span class="n">HTTPD_PORT</span><span class="p">:</span> <span class="mi">8081</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 设置日志级别 [DEBUG, INFO, WARN, ERROR, FATAL, CRITICAL]</span>
</span></span><span class="line"><span class="cl"><span class="n">LOG_LEVEL</span><span class="p">:</span> <span class="n">DEBUG</span>           <span class="c1"># 开发建议设置 DEBUG, 生产环境推荐使用 ERROR</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Guacamole Server ip， 默认127.0.0.1</span>
</span></span><span class="line"><span class="cl"><span class="c1"># GUA_HOST: 127.0.0.1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Guacamole Server 端口号，默认4822</span>
</span></span><span class="line"><span class="cl"><span class="c1"># GUA_PORT: 4822</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 会话共享使用的类型 [local, redis], 默认local</span>
</span></span><span class="line"><span class="cl"><span class="c1"># SHARE_ROOM_TYPE: local</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Redis配置</span>
</span></span><span class="line"><span class="cl"><span class="c1"># REDIS_HOST: 127.0.0.1</span>
</span></span><span class="line"><span class="cl"><span class="c1"># REDIS_PORT: 6379</span>
</span></span><span class="line"><span class="cl"><span class="c1"># REDIS_PASSWORD:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># REDIS_DB_ROOM:</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="启动guacd程序">启动guacd程序
</h3><p>都是官网提供的教程，学会操作，确保操作正确即可。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/etc/init.d/guacd start
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[root@master-61 /opt/lion-v2.12.0-linux-amd64]#/etc/init.d/guacd start
</span></span><span class="line"><span class="cl">Starting guacd: guacd[13422]: INFO:	Guacamole proxy daemon (guacd) version 1.3.0 started
</span></span><span class="line"><span class="cl">SUCCESS
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="启动lion进程">启动lion进程
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[root@master-61 /opt/lion-v2.12.0-linux-amd64]#nohup ./lion -f config.yml &amp;
</span></span><span class="line"><span class="cl">[3] 13435
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608184024733.png"
	width="3594"
	height="1699"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608184024733_hu8488357187724917432.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608184024733_hu7977282904827098517.png 1024w"
	loading="lazy"
	
		alt="image-20220608184024733"
	
	
		class="gallery-image" 
		data-flex-grow="211"
		data-flex-basis="507px"
	
></p>
<h2 id="部署nginx整合所有组件提供统一的七层反向代理">部署nginx（整合所有组件，提供统一的七层反向代理）
</h2><h3 id="部署nginx的配置文件">部署nginx的配置文件
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1. 确保nginx安装，在大于 1.18版本即可
</span></span><span class="line"><span class="cl">[nginx-stable]
</span></span><span class="line"><span class="cl">name=nginx stable repo
</span></span><span class="line"><span class="cl">baseurl=http://nginx.org/packages/centos/$releasever/$basearch/
</span></span><span class="line"><span class="cl">gpgcheck=1
</span></span><span class="line"><span class="cl">enabled=1
</span></span><span class="line"><span class="cl">gpgkey=https://nginx.org/keys/nginx_signing.key
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2. 安装nginx
</span></span><span class="line"><span class="cl">yum install nginx -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">3. 配置nginx虚拟主机文件，实现整合所有jumpserver的组件，统一访问入口，如
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">jumpserver.linux0224.cc 默认80端口即可。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">4.具体配置文件如下
</span></span><span class="line"><span class="cl">[root@master-61 /etc/yum.repos.d]#cd /etc/nginx/conf.d/
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#ls
</span></span><span class="line"><span class="cl">default.conf
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#rm -f default.conf 
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server {
</span></span><span class="line"><span class="cl">  listen 80;
</span></span><span class="line"><span class="cl">  # 不做域名解析，基于ip:port直接访问
</span></span><span class="line"><span class="cl">  # server_name www.lijinit.cn;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  client_max_body_size 5000m;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  # Luna 配置
</span></span><span class="line"><span class="cl">  # 经过实测，这个v12版本，只能http://10.0.0.61:4200/luna/这样去访问，前端这里有点难处理。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  location /luna/ {
</span></span><span class="line"><span class="cl">    proxy_pass http://luna:4200;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  # Core data 静态资源
</span></span><span class="line"><span class="cl">  location /media/replay/ {
</span></span><span class="line"><span class="cl">    add_header Content-Encoding gzip;
</span></span><span class="line"><span class="cl">    root /opt/jumpserver-v2.12.0/data/;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  location /media/ {
</span></span><span class="line"><span class="cl">    root /opt/jumpserver-v2.12.0/data/;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  location /static/ {
</span></span><span class="line"><span class="cl">    root /opt/jumpserver-v2.12.0/data/;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  # KoKo Lion 配置
</span></span><span class="line"><span class="cl">  location /koko/ {
</span></span><span class="line"><span class="cl">    proxy_pass       http://koko:5000;
</span></span><span class="line"><span class="cl">    proxy_set_header X-Real-IP $remote_addr;
</span></span><span class="line"><span class="cl">    proxy_set_header Host $host;
</span></span><span class="line"><span class="cl">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class="line"><span class="cl">    proxy_http_version 1.1;
</span></span><span class="line"><span class="cl">    proxy_buffering off;
</span></span><span class="line"><span class="cl">    proxy_set_header Upgrade $http_upgrade;
</span></span><span class="line"><span class="cl">    proxy_set_header Connection &#34;upgrade&#34;;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  # lion 配置
</span></span><span class="line"><span class="cl">  location /lion/ {
</span></span><span class="line"><span class="cl">    proxy_pass http://lion:8081;
</span></span><span class="line"><span class="cl">    proxy_buffering off;
</span></span><span class="line"><span class="cl">    proxy_request_buffering off;
</span></span><span class="line"><span class="cl">    proxy_http_version 1.1;
</span></span><span class="line"><span class="cl">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class="line"><span class="cl">    proxy_set_header Upgrade $http_upgrade;
</span></span><span class="line"><span class="cl">    proxy_set_header Connection $http_connection;
</span></span><span class="line"><span class="cl">    proxy_ignore_client_abort on;
</span></span><span class="line"><span class="cl">    proxy_connect_timeout 600;
</span></span><span class="line"><span class="cl">    proxy_send_timeout 600;
</span></span><span class="line"><span class="cl">    proxy_read_timeout 600;
</span></span><span class="line"><span class="cl">    send_timeout 6000;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  # Core 配置
</span></span><span class="line"><span class="cl">  location /ws/ {
</span></span><span class="line"><span class="cl">    proxy_pass http://core:8070;
</span></span><span class="line"><span class="cl">    proxy_set_header X-Real-IP $remote_addr;
</span></span><span class="line"><span class="cl">    proxy_set_header Host $host;
</span></span><span class="line"><span class="cl">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class="line"><span class="cl">    proxy_http_version 1.1;
</span></span><span class="line"><span class="cl">    proxy_buffering off;
</span></span><span class="line"><span class="cl">    proxy_set_header Upgrade $http_upgrade;
</span></span><span class="line"><span class="cl">    proxy_set_header Connection &#34;upgrade&#34;;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  location /api/ {
</span></span><span class="line"><span class="cl">    proxy_pass http://core:8080;
</span></span><span class="line"><span class="cl">    proxy_set_header X-Real-IP $remote_addr;
</span></span><span class="line"><span class="cl">    proxy_set_header Host $host;
</span></span><span class="line"><span class="cl">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  location /core/ {
</span></span><span class="line"><span class="cl">    proxy_pass http://core:8080;
</span></span><span class="line"><span class="cl">    proxy_set_header X-Real-IP $remote_addr;
</span></span><span class="line"><span class="cl">    proxy_set_header Host $host;
</span></span><span class="line"><span class="cl">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  # 前端 Lina
</span></span><span class="line"><span class="cl">  location /ui/ {
</span></span><span class="line"><span class="cl">    proxy_pass http://lina:9528;
</span></span><span class="line"><span class="cl">    proxy_set_header X-Real-IP $remote_addr;
</span></span><span class="line"><span class="cl">    proxy_set_header Host $host;
</span></span><span class="line"><span class="cl">    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  location / {
</span></span><span class="line"><span class="cl">    rewrite ^/(.*)$ /ui/$1 last;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="图解nginx配置">图解nginx配置
</h2><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608185502518.png"
	width="3185"
	height="1852"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608185502518_hu1118863393189204310.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608185502518_hu14782734682843730848.png 1024w"
	loading="lazy"
	
		alt="image-20220608185502518"
	
	
		class="gallery-image" 
		data-flex-grow="171"
		data-flex-basis="412px"
	
></p>
<hr>
<p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608185823467.png"
	width="2809"
	height="1893"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608185823467_hu14702752159488550097.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608185823467_hu7602961302957093754.png 1024w"
	loading="lazy"
	
		alt="image-20220608185823467"
	
	
		class="gallery-image" 
		data-flex-grow="148"
		data-flex-basis="356px"
	
></p>
<h3 id="注意配置文件中用的都是测试域名你要在master-61上做好hosts解析">注意，配置文件中用的都是测试域名，你要在master-61上做好hosts解析
</h3><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608185956239.png"
	width="1645"
	height="1800"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608185956239_hu1861372495680173660.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608185956239_hu8286623194350655330.png 1024w"
	loading="lazy"
	
		alt="image-20220608185956239"
	
	
		class="gallery-image" 
		data-flex-grow="91"
		data-flex-basis="219px"
	
></p>
<h3 id="最后启动nginx访问入口">最后，启动nginx，访问入口
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#nginx -t
</span></span><span class="line"><span class="cl">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
</span></span><span class="line"><span class="cl">nginx: configuration file /etc/nginx/nginx.conf test is successful
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#nginx
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#ps -ef|grep nginx
</span></span><span class="line"><span class="cl">root      13675      1  0 19:01 ?        00:00:00 nginx: master process nginx
</span></span><span class="line"><span class="cl">nginx     13676  13675  0 19:01 ?        00:00:00 nginx: worker process
</span></span><span class="line"><span class="cl">nginx     13677  13675  0 19:01 ?        00:00:00 nginx: worker process
</span></span><span class="line"><span class="cl">nginx     13678  13675  0 19:01 ?        00:00:00 nginx: worker process
</span></span><span class="line"><span class="cl">nginx     13679  13675  0 19:01 ?        00:00:00 nginx: worker process
</span></span><span class="line"><span class="cl">root      13681   1333  0 19:01 pts/0    00:00:00 grep --color=auto nginx
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#
</span></span><span class="line"><span class="cl">[root@master-61 /etc/nginx/conf.d]#
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="注意客户端windows也做好域名解析">注意，客户端，windows也做好域名解析
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">不用域名解析了。
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="最终访问访问堡垒机官网">最终访问，访问堡垒机官网
</h1><p>这里，不能用域名去测试了，用ip去访问即可，所有的后端进程，它还不认识你这个域名。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">访问入口是
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">http://10.0.0.61:80
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190526262.png"
	width="1928"
	height="1898"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190526262_hu4685490556491445985.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190526262_hu10506489697798141860.png 1024w"
	loading="lazy"
	
		alt="image-20220608190526262"
	
	
		class="gallery-image" 
		data-flex-grow="101"
		data-flex-basis="243px"
	
></p>
<h3 id="确保可以正确登录整个实验就没问题了">确保可以正确登录，整个实验就没问题了。
</h3><h3 id="堡垒机大盘页面">堡垒机大盘页面
</h3><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190552050.png"
	width="2206"
	height="1424"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190552050_hu9587741299431822221.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190552050_hu3688538011991354177.png 1024w"
	loading="lazy"
	
		alt="image-20220608190552050"
	
	
		class="gallery-image" 
		data-flex-grow="154"
		data-flex-basis="371px"
	
></p>
<h3 id="个人信息页面">个人信息页面
</h3><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190609915.png"
	width="1981"
	height="1481"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190609915_hu952844752821911216.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190609915_hu4190020172213444369.png 1024w"
	loading="lazy"
	
		alt="image-20220608190609915"
	
	
		class="gallery-image" 
		data-flex-grow="133"
		data-flex-basis="321px"
	
></p>
<h3 id="总之你在页面上确保点点点各种链接访问都是正常的">总之，你在页面上，确保点点点，各种链接，访问都是正常的
</h3><p>你的这个堡垒机才是正确的部署完毕。</p>
<h3 id="以最终看到个人页面为结束">以最终看到，个人页面为结束
</h3><p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190817500.png"
	width="2222"
	height="1382"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190817500_hu4114792240155426189.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190817500_hu2099502906292447223.png 1024w"
	loading="lazy"
	
		alt="image-20220608190817500"
	
	
		class="gallery-image" 
		data-flex-grow="160"
		data-flex-basis="385px"
	
></p>
<p><img src="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190903591.png"
	width="2063"
	height="1450"
	srcset="/xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190903591_hu5707017813383611763.png 480w, /xiaoshi/p/%E9%83%A8%E7%BD%B2python%E7%BD%91%E7%AB%99/pic/image-20220608190903591_hu12705467456195429809.png 1024w"
	loading="lazy"
	
		alt="image-20220608190903591"
	
	
		class="gallery-image" 
		data-flex-grow="142"
		data-flex-basis="341px"
	
></p>

</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 小诗
    </section>
    
    <section class="powerby">
        使用 <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> 构建 <br />
        主题 <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.26.0">Stack</a></b> 由 <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> 设计
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/xiaoshi/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
